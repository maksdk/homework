"use strict";window.onload=function(){var e={},t=document.getElementById("addList");t.onclick=function(e){document.getElementById("addName").style.display="block",t.style.display="none",document.getElementById("saveList").addEventListener("click",a,!1),document.getElementById("cancelList").addEventListener("click",n,!1),document.getElementById("nameList").focus()};var a=function(e){var a=document.getElementById("columns"),n=document.getElementById("nameList"),r=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),c=document.createElement("div");r.classList.add("parentOutBlock"),a.insertBefore(r,a.children[a.children.length-1]),o.classList.add("outBlock"),o.setAttribute("draggable","true"),o.addEventListener("dragenter",s,!1),r.appendChild(o),i.classList.add("outBlockTitle"),i.innerText=n.value,i.setAttribute("draggable","true"),i.addEventListener("dragstart",l,!1),i.addEventListener("dragenter",p,!1),i.addEventListener("dragend",g,!1),o.appendChild(i),c.classList.add("addCard"),c.id="addCard",c.innerText="Добавить карточку...",c.style.display="flex",c.addEventListener("click",d,!1),o.appendChild(c),n.value=null,addName.style.display="none",t.style.display="block"},n=function(e){document.getElementById("addName").style.display="none",t.style.display="block"},d=function(e){var t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("textArea"),d=document.createElement("div"),s=document.createElement("button"),p=document.createElement("button");t.classList.add("parentInBlock");var c=e.target.parentNode.children.length-1;e.target.parentNode.insertBefore(t,e.target.parentNode.children[c]),a.classList.add("inBlock"),a.style.padding="0",a.style.backgroundColor="#E2E4E6",t.appendChild(a),a.setAttribute("draggable","true"),a.addEventListener("dragstart",l,!1),a.addEventListener("dragenter",i,!1),a.addEventListener("dragend",g,!1),n.classList.add("textArea"),n.id="textareaAddCard",a.appendChild(n),document.getElementById("textareaAddCard").focus(),d.classList.add("buttonsAddCard"),d.id="buttonsAddCardId",e.target.parentNode.appendChild(d),s.classList.add("buttonsAddCard--add"),s.innerText="Добавить",s.addEventListener("click",r,!1),d.appendChild(s),p.classList.add("buttonsAddCard--cancel"),p.innerText="Отмена",p.addEventListener("click",o,!1),d.appendChild(p),e.target.style.display="none"},r=function(e){var t=document.getElementById("textareaAddCard");t.parentNode.setAttribute("style","padding: 10px; background-color: #ffffff; width:160px;"),e.target.parentNode.previousSibling.style.display="block",e.target.parentNode.parentNode.removeChild(e.target.parentNode),t.parentNode.innerHTML=t.value},o=function(e){var t=document.getElementById("textareaAddCard"),a=t.parentNode.parentNode.parentNode;a.removeChild(document.getElementById("buttonsAddCardId"));var n=t.parentNode.parentNode.parentNode.children.length;a.children[n-1].style.display="block",a.removeChild(t.parentNode.parentNode),t.parentNode.removeChild(t)},l=function(t){var a=void 0,n=void 0;"outBlockTitle"==t.target.className?(n=t.target.parentNode.parentNode,a=t.target.parentNode):"inBlock"==t.target.className&&(n=t.target.parentNode,a=t.target),n.style.height=n.clientHeight-1+"px";var d=n.cloneNode(!0);document.body.appendChild(d),d.id="clone",d.style.position="absolute",d.style.top="-1000px",d.style.zIndex="-100";var r=c(t.target),o=t.pageX-r.left-30,l=t.pageY-r.top;t.dataTransfer.setDragImage(d,o,l),e.elem=t.target,e.parent=n,e.style=a.getAttribute("style"),e.deltaX=o,e.deltaY=l,a.style.zIndex=9999,a.style.position="absolute",a.style.opacity="0"},i=function(t){if(t.target!==e.elem&&"outBlockTitle"!=e.elem.className){var a=c(t.target);Math.abs(a.top-t.pageY)>15?"inBlock"!=t.target.parentNode.nextElementSibling.className&&"parentInBlock"!=t.target.parentNode.nextElementSibling.className?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):Math.abs(a.top-t.pageY)<=15&&(t.target.parentNode.parentNode.children[1]===t.target.parentNode?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},s=function(t){if("addCard"!=t.target.className&&null!=e.elem&&("outBlockTitle"==t.target.className||"outBlock"==t.target.className)&&"outBlockTitle"==e.elem.className&&e.elem!==t.target&&e.elem.parentNode!==t.target){var a=c(t.target);Math.abs(a.left-t.pageX)>100?"outBlockTitle"==t.target.className?t.target.parentNode.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.parentNode):e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):Math.abs(a.left-t.pageX)<100&&(console.log(t.target),console.log(t.target.parentNode.parentNode),console.log(e.parent===t.target.parentNode.nextElementSibling),"outBlockTitle"==t.target.className?(console.log("e.outBlockTitle"),t.target.parentNode.parentNode.parentNode.insertBefore(t.target.parentNode.parentNode,e.parent)):e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},p=function(t){"inBlock"==e.elem.className&&(t.target.parentNode.childElementCount>2||t.target.parentNode.insertBefore(e.parent,t.target.parentNode.children[1]))},c=function(e){var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset}},g=function(t){"outBlockTitle"==t.target.className?t.target.parentNode.setAttribute("style",e.style):t.target.setAttribute("style",e.style),e.parent.style.height="100%";var a=document.getElementById("clone");document.body.removeChild(a)}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvbWUuanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwiZHJhZ09iaiIsImFkZExpc3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwib25jbGljayIsImUiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwic2F2ZUxpc3QiLCJjYW5jZWxBZGRMaXN0IiwiZm9jdXMiLCJjb2x1bW5zIiwibmFtZUxpc3QiLCJwYXJlbnRPdXRCbG9jayIsImNyZWF0ZUVsZW1lbnQiLCJvdXRCbG9jayIsIm91dEJsb2NrVGl0bGUiLCJhZGRDYXJkIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5zZXJ0QmVmb3JlIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJzZXRBdHRyaWJ1dGUiLCJkcmFnRW50ZXJPdXRCbG9jayIsImFwcGVuZENoaWxkIiwiaW5uZXJUZXh0IiwidmFsdWUiLCJkcmFnU3RhcnQiLCJkcmFnRW50ZXJUaXRsZSIsImRyYWdFbmQiLCJpZCIsImFkZENhcmRJbkxpc3QiLCJhZGROYW1lIiwicGFyZW50SW5CbG9jayIsImluQmxvY2siLCJ0ZXh0QXJlYSIsImJ1dHRvbnNEaXYiLCJidXR0b25BZGQiLCJidXR0b25DYW5jZWwiLCJpbmRleCIsInRhcmdldCIsInBhcmVudE5vZGUiLCJwYWRkaW5nIiwiYmFja2dyb3VuZENvbG9yIiwiZHJhZ0VudGVySW5CbG9jayIsInNhdmVDYXJkSW5MaXN0IiwiY2FuY2VsQWRkQ2FyZEluTElzdCIsInRleHRhcmVhIiwicHJldmlvdXNTaWJsaW5nIiwicmVtb3ZlQ2hpbGQiLCJpbm5lckhUTUwiLCJwYXJlbnQiLCJlVGFyZ2V0IiwiY2xhc3NOYW1lIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiY2xvbmUiLCJjbG9uZU5vZGUiLCJib2R5IiwicG9zaXRpb24iLCJ0b3AiLCJ6SW5kZXgiLCJjb29yZHMiLCJnZXRDb29yZHMiLCJkZWx0YVgiLCJwYWdlWCIsImxlZnQiLCJkZWx0YVkiLCJwYWdlWSIsImRhdGFUcmFuc2ZlciIsInNldERyYWdJbWFnZSIsImVsZW0iLCJnZXRBdHRyaWJ1dGUiLCJvcGFjaXR5IiwiY29vcmQiLCJNYXRoIiwiYWJzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidW5kZWZpbmVkIiwiY29uc29sZSIsImxvZyIsImNoaWxkRWxlbWVudENvdW50IiwiYm94IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwicGFnZVlPZmZzZXQiLCJwYWdlWE9mZnNldCJdLCJtYXBwaW5ncyI6ImFBQUFBLE9BQU9DLE9BQVMsV0FDZixJQUFJQyxLQUNBQyxFQUFVQyxTQUFTQyxlQUFlLFdBQ3RDRixFQUFRRyxRQUFVLFNBQUNDLEdBQ0pILFNBQVNDLGVBQWUsV0FDN0JHLE1BQU1DLFFBQVUsUUFDeEJOLEVBQVFLLE1BQU1DLFFBQVUsT0FDZEwsU0FBU0MsZUFBZSxZQUM3QkssaUJBQWlCLFFBQVNDLEdBQVUsR0FDN0JQLFNBQVNDLGVBQWUsY0FDN0JLLGlCQUFpQixRQUFTRSxHQUFlLEdBQ2hEUixTQUFTQyxlQUFlLFlBQVlRLFNBRXRDLElBQUlGLEVBQVcsU0FBQ0osR0FDZixJQUFJTyxFQUFVVixTQUFTQyxlQUFlLFdBQ3JDVSxFQUFXWCxTQUFTQyxlQUFlLFlBQ25DVyxFQUFpQlosU0FBU2EsY0FBYyxPQUN4Q0MsRUFBV2QsU0FBU2EsY0FBYyxPQUNsQ0UsRUFBZ0JmLFNBQVNhLGNBQWMsT0FDdkNHLEVBQVVoQixTQUFTYSxjQUFjLE9BRWxDRCxFQUFlSyxVQUFVQyxJQUFJLGtCQUM3QlIsRUFBUVMsYUFBYVAsRUFBZ0JGLEVBQVFVLFNBQVNWLEVBQVFVLFNBQVNDLE9BQVMsSUFFaEZQLEVBQVNHLFVBQVVDLElBQUksWUFDdkJKLEVBQVNRLGFBQWEsWUFBYSxRQUNuQ1IsRUFBU1IsaUJBQWlCLFlBQWFpQixHQUFtQixHQUMxRFgsRUFBZVksWUFBWVYsR0FFM0JDLEVBQWNFLFVBQVVDLElBQUksaUJBQzVCSCxFQUFjVSxVQUFZZCxFQUFTZSxNQUNuQ1gsRUFBY08sYUFBYSxZQUFhLFFBQ3ZDUCxFQUFjVCxpQkFBaUIsWUFBYXFCLEdBQVcsR0FDdkRaLEVBQWNULGlCQUFpQixZQUFhc0IsR0FBZ0IsR0FDMURiLEVBQWNULGlCQUFpQixVQUFXdUIsR0FBUyxHQUNuRGYsRUFBU1UsWUFBWVQsR0FFeEJDLEVBQVFDLFVBQVVDLElBQUksV0FDdEJGLEVBQVFjLEdBQUssVUFDYmQsRUFBUVMsVUFBWSx1QkFDcEJULEVBQVFaLE1BQU1DLFFBQVUsT0FFeEJXLEVBQVFWLGlCQUFpQixRQUFTeUIsR0FBZSxHQUNqRGpCLEVBQVNVLFlBQVlSLEdBRXJCTCxFQUFTZSxNQUFRLEtBQ2pCTSxRQUFRNUIsTUFBTUMsUUFBVSxPQUN4Qk4sRUFBUUssTUFBTUMsUUFBVSxTQUdwQkcsRUFBZ0IsU0FBQ0wsR0FDUEgsU0FBU0MsZUFBZSxXQUM5QkcsTUFBTUMsUUFBVSxPQUN4Qk4sRUFBUUssTUFBTUMsUUFBVSxTQUVyQjBCLEVBQWdCLFNBQUM1QixHQUNwQixJQUFJOEIsRUFBZ0JqQyxTQUFTYSxjQUFjLE9BQzFDcUIsRUFBVWxDLFNBQVNhLGNBQWMsT0FDOUJzQixFQUFXbkMsU0FBU2EsY0FBYyxZQUNsQ3VCLEVBQWFwQyxTQUFTYSxjQUFjLE9BQ3BDd0IsRUFBWXJDLFNBQVNhLGNBQWMsVUFDbkN5QixFQUFldEMsU0FBU2EsY0FBYyxVQUd2Q29CLEVBQWNoQixVQUFVQyxJQUFJLGlCQUM1QixJQUFJcUIsRUFBUXBDLEVBQUVxQyxPQUFPQyxXQUFXckIsU0FBU0MsT0FBUyxFQUNsRGxCLEVBQUVxQyxPQUFPQyxXQUFXdEIsYUFBYWMsRUFBZTlCLEVBQUVxQyxPQUFPQyxXQUFXckIsU0FBU21CLElBRTdFTCxFQUFRakIsVUFBVUMsSUFBSSxXQUN6QmdCLEVBQVE5QixNQUFNc0MsUUFBVSxJQUN4QlIsRUFBUTlCLE1BQU11QyxnQkFBa0IsVUFDaENWLEVBQWNULFlBQVlVLEdBQzFCQSxFQUFRWixhQUFhLFlBQWEsUUFDakNZLEVBQVE1QixpQkFBaUIsWUFBYXFCLEdBQVcsR0FDakRPLEVBQVE1QixpQkFBaUIsWUFBYXNDLEdBQWtCLEdBQ3REVixFQUFRNUIsaUJBQWlCLFVBQVd1QixHQUFTLEdBRWhETSxFQUFTbEIsVUFBVUMsSUFBSSxZQUN2QmlCLEVBQVNMLEdBQUssa0JBQ2RJLEVBQVFWLFlBQVlXLEdBQ3BCbkMsU0FBU0MsZUFBZSxtQkFBbUJRLFFBRzNDMkIsRUFBV25CLFVBQVVDLElBQUksa0JBQ3pCa0IsRUFBV04sR0FBSyxtQkFDaEIzQixFQUFFcUMsT0FBT0MsV0FBV2pCLFlBQVlZLEdBRWhDQyxFQUFVcEIsVUFBVUMsSUFBSSx1QkFDeEJtQixFQUFVWixVQUFZLFdBQ3RCWSxFQUFVL0IsaUJBQWlCLFFBQVN1QyxHQUFnQixHQUNwRFQsRUFBV1osWUFBWWEsR0FFdkJDLEVBQWFyQixVQUFVQyxJQUFJLDBCQUMzQm9CLEVBQWFiLFVBQVksU0FDekJhLEVBQWFoQyxpQkFBaUIsUUFBU3dDLEdBQXFCLEdBQzVEVixFQUFXWixZQUFZYyxHQUV2Qm5DLEVBQUVxQyxPQUFPcEMsTUFBTUMsUUFBVSxRQUd0QndDLEVBQWlCLFNBQUMxQyxHQUNyQixJQUFJNEMsRUFBVy9DLFNBQVNDLGVBQWUsbUJBQ3ZDOEMsRUFBU04sV0FBV25CLGFBQWEsUUFBUywwREFDMUNuQixFQUFFcUMsT0FBT0MsV0FBV08sZ0JBQWdCNUMsTUFBTUMsUUFBVSxRQUNwREYsRUFBRXFDLE9BQU9DLFdBQVdBLFdBQVdRLFlBQVk5QyxFQUFFcUMsT0FBT0MsWUFDcERNLEVBQVNOLFdBQVdTLFVBQVlILEVBQVNyQixPQUd0Q29CLEVBQXNCLFNBQUMzQyxHQUMxQixJQUFJNEMsRUFBVy9DLFNBQVNDLGVBQWUsbUJBQ25Da0QsRUFBU0osRUFBU04sV0FBV0EsV0FBV0EsV0FDNUNVLEVBQU9GLFlBQVlqRCxTQUFTQyxlQUFlLHFCQUUzQyxJQUFJc0MsRUFBUVEsRUFBU04sV0FBV0EsV0FBV0EsV0FBV3JCLFNBQVNDLE9BQy9EOEIsRUFBTy9CLFNBQVNtQixFQUFRLEdBQUduQyxNQUFNQyxRQUFVLFFBQzNDOEMsRUFBT0YsWUFBWUYsRUFBU04sV0FBV0EsWUFDdkNNLEVBQVNOLFdBQVdRLFlBQVlGLElBSTdCcEIsRUFBWSxTQUFDeEIsR0FDaEIsSUFBSWlELE9BQUFBLEVBQVNELE9BQUFBLEVBQ1ksaUJBQXRCaEQsRUFBRXFDLE9BQU9hLFdBQ1ZGLEVBQVNoRCxFQUFFcUMsT0FBT0MsV0FBV0EsV0FDN0JXLEVBQVVqRCxFQUFFcUMsT0FBT0MsWUFDWSxXQUF0QnRDLEVBQUVxQyxPQUFPYSxZQUNuQkYsRUFBU2hELEVBQUVxQyxPQUFPQyxXQUNqQlcsRUFBVWpELEVBQUVxQyxRQUViVyxFQUFPL0MsTUFBTWtELE9BQVNILEVBQU9JLGFBQWUsRUFBSSxLQUVqRCxJQUFJQyxFQUFRTCxFQUFPTSxXQUFVLEdBQzVCekQsU0FBUzBELEtBQUtsQyxZQUFZZ0MsR0FDM0JBLEVBQU0xQixHQUFLLFFBQ1gwQixFQUFNcEQsTUFBTXVELFNBQVcsV0FDdkJILEVBQU1wRCxNQUFNd0QsSUFBTSxVQUNsQkosRUFBTXBELE1BQU15RCxPQUFTLE9BRXJCLElBQUlDLEVBQVNDLEVBQVU1RCxFQUFFcUMsUUFDckJ3QixFQUFTN0QsRUFBRThELE1BQVFILEVBQU9JLEtBQU8sR0FDakNDLEVBQVNoRSxFQUFFaUUsTUFBUU4sRUFBT0YsSUFDOUJ6RCxFQUFFa0UsYUFBYUMsYUFBYWQsRUFBT1EsRUFBUUcsR0FDM0NyRSxFQUFReUUsS0FBT3BFLEVBQUVxQyxPQUNqQjFDLEVBQVFxRCxPQUFTQSxFQUNqQnJELEVBQVFNLE1BQVFnRCxFQUFRb0IsYUFBYSxTQUNyQzFFLEVBQVFrRSxPQUFTQSxFQUNqQmxFLEVBQVFxRSxPQUFTQSxFQUVqQmYsRUFBUWhELE1BQU15RCxPQUFTLEtBQ3RCVCxFQUFRaEQsTUFBTXVELFNBQVcsV0FDekJQLEVBQVFoRCxNQUFNcUUsUUFBVSxLQUd0QjdCLEVBQW1CLFNBQUN6QyxHQUN2QixHQUFJQSxFQUFFcUMsU0FBVzFDLEVBQVF5RSxNQUNLLGlCQUExQnpFLEVBQVF5RSxLQUFLbEIsVUFBakIsQ0FDQSxJQUFJcUIsRUFBUVgsRUFBVTVELEVBQUVxQyxRQUNyQm1DLEtBQUtDLElBQUlGLEVBQU1kLElBQU16RCxFQUFFaUUsT0FBUyxHQUNxQixXQUFwRGpFLEVBQUVxQyxPQUFPQyxXQUFXb0MsbUJBQW1CeEIsV0FDVyxpQkFBcERsRCxFQUFFcUMsT0FBT0MsV0FBV29DLG1CQUFtQnhCLFVBQ3ZDbEQsRUFBRXFDLE9BQU9DLFdBQVdBLFdBQVd0QixhQUFhckIsRUFBUXFELE9BQVFoRCxFQUFFcUMsT0FBT0MsV0FBV29DLG9CQUVoRjFFLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFXdEIsYUFBYXJCLEVBQVFxRCxPQUFRaEQsRUFBRXFDLE9BQU9DLFlBRTVEa0MsS0FBS0MsSUFBSUYsRUFBTWQsSUFBTXpELEVBQUVpRSxRQUFVLEtBQ3ZDakUsRUFBRXFDLE9BQU9DLFdBQVdBLFdBQVdyQixTQUFTLEtBQU9qQixFQUFFcUMsT0FBT0MsV0FDM0R0QyxFQUFFcUMsT0FBT0MsV0FBV0EsV0FBV3RCLGFBQWFyQixFQUFRcUQsT0FBUWhELEVBQUVxQyxPQUFPQyxZQUVyRXRDLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFXdEIsYUFBYXJCLEVBQVFxRCxPQUFRaEQsRUFBRXFDLE9BQU9DLFdBQVdvQyx1QkFJL0V0RCxFQUFvQixTQUFDcEIsR0FDeEIsR0FBeUIsV0FBdEJBLEVBQUVxQyxPQUFPYSxXQUNPeUIsTUFBaEJoRixFQUFReUUsT0FDZSxpQkFBdEJwRSxFQUFFcUMsT0FBT2EsV0FDVSxZQUF0QmxELEVBQUVxQyxPQUFPYSxZQUNpQixpQkFBMUJ2RCxFQUFReUUsS0FBS2xCLFdBQ2J2RCxFQUFReUUsT0FBU3BFLEVBQUVxQyxRQUNuQjFDLEVBQVF5RSxLQUFLOUIsYUFBZXRDLEVBQUVxQyxPQUovQixDQUtDLElBQUlrQyxFQUFRWCxFQUFVNUQsRUFBRXFDLFFBQ3BCbUMsS0FBS0MsSUFBSUYsRUFBTVIsS0FBTy9ELEVBQUU4RCxPQUFTLElBQ1YsaUJBQXRCOUQsRUFBRXFDLE9BQU9hLFVBQ1psRCxFQUFFcUMsT0FBT0MsV0FBV0EsV0FBV0EsV0FBV3RCLGFBQWFyQixFQUFRcUQsT0FBUWhELEVBQUVxQyxPQUFPQyxXQUFXQSxZQUNqRjNDLEVBQVFxRCxTQUFXaEQsRUFBRXFDLE9BQU9DLFdBQVdvQyxtQkFDakQxRSxFQUFFcUMsT0FBT0MsV0FBV0EsV0FBV3RCLGFBQWFyQixFQUFRcUQsT0FBUWhELEVBQUVxQyxPQUFPQyxZQUVyRXRDLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFXdEIsYUFBYXJCLEVBQVFxRCxPQUFRaEQsRUFBRXFDLE9BQU9DLFdBQVdvQyxvQkFFeEVGLEtBQUtDLElBQUlGLEVBQU1SLEtBQU8vRCxFQUFFOEQsT0FBUyxNQUMxQ2MsUUFBUUMsSUFBSTdFLEVBQUVxQyxRQUNkdUMsUUFBUUMsSUFBSTdFLEVBQUVxQyxPQUFPQyxXQUFXQSxZQUNoQ3NDLFFBQVFDLElBQUlsRixFQUFRcUQsU0FBV2hELEVBQUVxQyxPQUFPQyxXQUFXb0Msb0JBQ3pCLGlCQUF0QjFFLEVBQUVxQyxPQUFPYSxXQUNaMEIsUUFBUUMsSUFBSSxtQkFDWjdFLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFXQSxXQUFXdEIsYUFBYWhCLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFZM0MsRUFBUXFELFNBQ3JGckQsRUFBUXFELFNBQVdoRCxFQUFFcUMsT0FBT0MsV0FBV29DLG1CQUNqRDFFLEVBQUVxQyxPQUFPQyxXQUFXQSxXQUFXdEIsYUFBYXJCLEVBQVFxRCxPQUFRaEQsRUFBRXFDLE9BQU9DLFlBRXJFdEMsRUFBRXFDLE9BQU9DLFdBQVdBLFdBQVd0QixhQUFhckIsRUFBUXFELE9BQVFoRCxFQUFFcUMsT0FBT0MsV0FBV29DLHVCQUtoRmpELEVBQWlCLFNBQUN6QixHQUNTLFdBQTFCTCxFQUFReUUsS0FBS2xCLFlBQ2JsRCxFQUFFcUMsT0FBT0MsV0FBV3dDLGtCQUFvQixHQUM1QzlFLEVBQUVxQyxPQUFPQyxXQUFXdEIsYUFBYXJCLEVBQVFxRCxPQUFRaEQsRUFBRXFDLE9BQU9DLFdBQVdyQixTQUFTLE1BRTFFMkMsRUFBWSxTQUFDUSxHQUNoQixJQUFJVyxFQUFNWCxFQUFLWSx3QkFDaEIsT0FDR3ZCLElBQUtzQixFQUFJdEIsSUFBTXdCLFlBQ2ZsQixLQUFNZ0IsRUFBSWhCLEtBQU9tQixjQUdqQnhELEVBQVUsU0FBQzFCLEdBQ1EsaUJBQXRCQSxFQUFFcUMsT0FBT2EsVUFDVGxELEVBQUVxQyxPQUFPQyxXQUFXbkIsYUFBYSxRQUFTeEIsRUFBUU0sT0FDbERELEVBQUVxQyxPQUFPbEIsYUFBYSxRQUFTeEIsRUFBUU0sT0FDdkNOLEVBQVFxRCxPQUFPL0MsTUFBTWtELE9BQVMsT0FDOUIsSUFBSUUsRUFBUXhELFNBQVNDLGVBQWUsU0FDcENELFNBQVMwRCxLQUFLVCxZQUFZTyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuXHRsZXQgZHJhZ09iaiA9IHt9O1xyXG5cdGxldCBhZGRMaXN0XHQ9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkTGlzdFwiKTtcclxuXHRhZGRMaXN0Lm9uY2xpY2sgPSAoZSk9PntcclxuXHRcdGxldCBhZGROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGROYW1lXCIpO1xyXG5cdFx0XHRhZGROYW1lLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0XHRcdGFkZExpc3Quc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdFx0bGV0IHNhdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhdmVMaXN0XCIpO1xyXG5cdFx0XHRzYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzYXZlTGlzdCwgZmFsc2UpO1xyXG5cdFx0bGV0IGNhbmNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsTGlzdFwiKTtcclxuXHRcdFx0Y2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYW5jZWxBZGRMaXN0LCBmYWxzZSk7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZUxpc3RcIikuZm9jdXMoKTtcclxuXHR9XHJcblx0bGV0IHNhdmVMaXN0ID0gKGUpPT57XHJcblx0XHRsZXQgY29sdW1ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29sdW1uc1wiKSxcclxuXHRcdFx0bmFtZUxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVMaXN0XCIpLFxyXG5cdFx0XHRwYXJlbnRPdXRCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHRcdG91dEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdFx0b3V0QmxvY2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHRcdGFkZENhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cclxuXHRcdHBhcmVudE91dEJsb2NrLmNsYXNzTGlzdC5hZGQoXCJwYXJlbnRPdXRCbG9ja1wiKTtcclxuXHRcdGNvbHVtbnMuaW5zZXJ0QmVmb3JlKHBhcmVudE91dEJsb2NrLCBjb2x1bW5zLmNoaWxkcmVuW2NvbHVtbnMuY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cclxuXHRcdG91dEJsb2NrLmNsYXNzTGlzdC5hZGQoXCJvdXRCbG9ja1wiKTtcclxuXHRcdG91dEJsb2NrLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcclxuXHRcdG91dEJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdFbnRlck91dEJsb2NrLCBmYWxzZSk7XHJcblx0XHRwYXJlbnRPdXRCbG9jay5hcHBlbmRDaGlsZChvdXRCbG9jayk7XHJcblx0XHRcclxuXHRcdG91dEJsb2NrVGl0bGUuY2xhc3NMaXN0LmFkZChcIm91dEJsb2NrVGl0bGVcIik7XHJcblx0XHRvdXRCbG9ja1RpdGxlLmlubmVyVGV4dCA9IG5hbWVMaXN0LnZhbHVlO1xyXG5cdFx0b3V0QmxvY2tUaXRsZS5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsICd0cnVlJyk7XHJcbiBcdFx0b3V0QmxvY2tUaXRsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBkcmFnU3RhcnQsIGZhbHNlKTtcclxuIFx0XHRvdXRCbG9ja1RpdGxlLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdFbnRlclRpdGxlLCBmYWxzZSk7XHJcbiAgICBcdG91dEJsb2NrVGl0bGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGRyYWdFbmQsIGZhbHNlKTtcclxuICAgIFx0b3V0QmxvY2suYXBwZW5kQ2hpbGQob3V0QmxvY2tUaXRsZSk7XHJcblx0XHRcclxuXHRcdGFkZENhcmQuY2xhc3NMaXN0LmFkZChcImFkZENhcmRcIik7XHJcblx0XHRhZGRDYXJkLmlkID0gXCJhZGRDYXJkXCI7XHJcblx0XHRhZGRDYXJkLmlubmVyVGV4dCA9IFwi0JTQvtCx0LDQstC40YLRjCDQutCw0YDRgtC+0YfQutGDLi4uXCI7XHJcblx0XHRhZGRDYXJkLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcclxuXHJcblx0XHRhZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhZGRDYXJkSW5MaXN0LCBmYWxzZSk7XHJcblx0XHRvdXRCbG9jay5hcHBlbmRDaGlsZChhZGRDYXJkKTtcclxuXHJcblx0XHRuYW1lTGlzdC52YWx1ZSA9IG51bGw7XHJcblx0XHRhZGROYW1lLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHRcdGFkZExpc3Quc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHR9XHJcblxyXG5cdGxldCAgY2FuY2VsQWRkTGlzdCA9IChlKT0+e1xyXG5cdFx0bGV0IGFkZE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZE5hbWVcIik7XHJcblx0XHRhZGROYW1lLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHRcdGFkZExpc3Quc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHR9XHJcblx0bGV0IGFkZENhcmRJbkxpc3QgPSAoZSk9PntcclxuXHRcdGxldCBwYXJlbnRJbkJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdFx0aW5CbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHQgICAgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dEFyZWFcIiksXHJcblx0XHQgICAgYnV0dG9uc0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHQgICAgYnV0dG9uQWRkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKSxcclxuXHRcdCAgICBidXR0b25DYW5jZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG5cdFx0ICAgIFxyXG5cdCAgICAvL9Cy0YHRgtCw0LLQu9GP0LXQvCDQv9C10YDQtdC0INC60L3QvtC/0LrQvtC5INC00L7QsdCw0LLQuNGC0Ywg0YHQv9C40YHQvtC6XHJcblx0ICAgIHBhcmVudEluQmxvY2suY2xhc3NMaXN0LmFkZChcInBhcmVudEluQmxvY2tcIik7XHJcblx0ICAgIGxldCBpbmRleCA9IGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRyZW4ubGVuZ3RoIC0gMTtcclxuXHQgICAgZS50YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocGFyZW50SW5CbG9jaywgZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlbltpbmRleF0pO1xyXG5cdFxyXG5cdCAgICBpbkJsb2NrLmNsYXNzTGlzdC5hZGQoXCJpbkJsb2NrXCIpO1xyXG5cdFx0aW5CbG9jay5zdHlsZS5wYWRkaW5nID0gXCIwXCI7XHJcblx0XHRpbkJsb2NrLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0UyRTRFNlwiO1xyXG5cdFx0cGFyZW50SW5CbG9jay5hcHBlbmRDaGlsZChpbkJsb2NrKTtcclxuXHRcdGluQmxvY2suc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xyXG4gXHRcdGluQmxvY2suYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgZHJhZ1N0YXJ0LCBmYWxzZSk7XHJcbiBcdFx0aW5CbG9jay5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW50ZXInLCBkcmFnRW50ZXJJbkJsb2NrLCBmYWxzZSk7XHJcbiAgICBcdGluQmxvY2suYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGRyYWdFbmQsIGZhbHNlKTtcclxuXHRcdFx0XHJcblx0XHR0ZXh0QXJlYS5jbGFzc0xpc3QuYWRkKFwidGV4dEFyZWFcIik7XHJcblx0XHR0ZXh0QXJlYS5pZCA9IFwidGV4dGFyZWFBZGRDYXJkXCI7XHJcblx0XHRpbkJsb2NrLmFwcGVuZENoaWxkKHRleHRBcmVhKTtcclxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGV4dGFyZWFBZGRDYXJkXCIpLmZvY3VzKCk7XHJcblx0XHQvL3RleHRBcmVhLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGxvc2VGb2N1c1RleHRhcmVhLCBmYWxzZSk7XHJcblxyXG5cdFx0YnV0dG9uc0Rpdi5jbGFzc0xpc3QuYWRkKFwiYnV0dG9uc0FkZENhcmRcIik7XHJcblx0XHRidXR0b25zRGl2LmlkID0gXCJidXR0b25zQWRkQ2FyZElkXCI7XHJcblx0XHRlLnRhcmdldC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGJ1dHRvbnNEaXYpO1xyXG5cclxuXHRcdGJ1dHRvbkFkZC5jbGFzc0xpc3QuYWRkKFwiYnV0dG9uc0FkZENhcmQtLWFkZFwiKTtcclxuXHRcdGJ1dHRvbkFkZC5pbm5lclRleHQgPSBcItCU0L7QsdCw0LLQuNGC0YxcIjtcclxuXHRcdGJ1dHRvbkFkZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2F2ZUNhcmRJbkxpc3QsIGZhbHNlKTtcclxuXHRcdGJ1dHRvbnNEaXYuYXBwZW5kQ2hpbGQoYnV0dG9uQWRkKTtcclxuXHJcblx0XHRidXR0b25DYW5jZWwuY2xhc3NMaXN0LmFkZChcImJ1dHRvbnNBZGRDYXJkLS1jYW5jZWxcIik7XHJcblx0XHRidXR0b25DYW5jZWwuaW5uZXJUZXh0ID0gXCLQntGC0LzQtdC90LBcIjtcclxuXHRcdGJ1dHRvbkNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2FuY2VsQWRkQ2FyZEluTElzdCwgZmFsc2UpO1xyXG5cdFx0YnV0dG9uc0Rpdi5hcHBlbmRDaGlsZChidXR0b25DYW5jZWwpO1xyXG5cclxuXHRcdGUudGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHR9XHJcblxyXG5cdGxldCBzYXZlQ2FyZEluTGlzdCA9IChlKT0+e1xyXG5cdFx0bGV0IHRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0YXJlYUFkZENhcmRcIik7XHJcblx0XHR0ZXh0YXJlYS5wYXJlbnROb2RlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwicGFkZGluZzogMTBweDsgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsgd2lkdGg6MTYwcHg7XCIpO1xyXG5cdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wcmV2aW91c1NpYmxpbmcuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlLnRhcmdldC5wYXJlbnROb2RlKTtcclxuXHRcdHRleHRhcmVhLnBhcmVudE5vZGUuaW5uZXJIVE1MID0gdGV4dGFyZWEudmFsdWU7XHJcblx0fVxyXG5cclxuXHRsZXQgY2FuY2VsQWRkQ2FyZEluTElzdCA9IChlKT0+e1xyXG5cdFx0bGV0IHRleHRhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0YXJlYUFkZENhcmRcIik7XHJcblx0XHRsZXQgcGFyZW50ID0gdGV4dGFyZWEucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XHJcblx0XHRwYXJlbnQucmVtb3ZlQ2hpbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25zQWRkQ2FyZElkXCIpKTtcclxuXHRcdFxyXG5cdFx0bGV0IGluZGV4ID0gdGV4dGFyZWEucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW4ubGVuZ3RoO1xyXG5cdFx0cGFyZW50LmNoaWxkcmVuW2luZGV4IC0gMV0uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHRcdHBhcmVudC5yZW1vdmVDaGlsZCh0ZXh0YXJlYS5wYXJlbnROb2RlLnBhcmVudE5vZGUpO1xyXG5cdFx0dGV4dGFyZWEucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0ZXh0YXJlYSk7XHJcblx0fVxyXG5cdGxldCBsb3NlRm9jdXNUZXh0YXJlYSA9IChlKT0+e1xyXG5cdH1cdFxyXG5cdGxldCBkcmFnU3RhcnQgPSAoZSkgPT57XHJcblx0XHRsZXQgZVRhcmdldCwgcGFyZW50LCBkZWx0YUNvb3JkcztcclxuXHRcdGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIil7XHJcblx0IFx0XHRwYXJlbnQgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGU7XHJcblx0IFx0XHRlVGFyZ2V0ID0gZS50YXJnZXQucGFyZW50Tm9kZTtcclxuXHQgXHR9IGVsc2UgaWYoZS50YXJnZXQuY2xhc3NOYW1lID09IFwiaW5CbG9ja1wiKSB7XHJcblx0XHRcdHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XHJcblx0IFx0XHRlVGFyZ2V0ID0gZS50YXJnZXQ7XHJcblx0IFx0fVxyXG5cdCBcdHBhcmVudC5zdHlsZS5oZWlnaHQgPSBwYXJlbnQuY2xpZW50SGVpZ2h0IC0gMSArIFwicHhcIjtcclxuXHRcdFxyXG5cdFx0bGV0IGNsb25lID0gcGFyZW50LmNsb25lTm9kZSh0cnVlKTtcclxuXHQgXHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNsb25lKTtcclxuXHRcdGNsb25lLmlkID0gXCJjbG9uZVwiO1xyXG5cdFx0Y2xvbmUuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7ICAgIFxyXG5cdFx0Y2xvbmUuc3R5bGUudG9wID0gXCItMTAwMHB4XCI7XHJcblx0XHRjbG9uZS5zdHlsZS56SW5kZXggPSBcIi0xMDBcIjtcclxuXHRcdCBcclxuXHRcdGxldCBjb29yZHMgPSBnZXRDb29yZHMoZS50YXJnZXQpO1xyXG5cdFx0bGV0IGRlbHRhWCA9IGUucGFnZVggLSBjb29yZHMubGVmdCAtIDMwLFxyXG5cdFx0ICAgIGRlbHRhWSA9IGUucGFnZVkgLSBjb29yZHMudG9wO1xyXG5cdFx0ZS5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlKGNsb25lLCBkZWx0YVgsIGRlbHRhWSk7IFxyXG5cdFx0ZHJhZ09iai5lbGVtID0gZS50YXJnZXQ7XHJcblx0XHRkcmFnT2JqLnBhcmVudCA9IHBhcmVudDtcclxuXHRcdGRyYWdPYmouc3R5bGUgPSBlVGFyZ2V0LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xyXG5cdFx0ZHJhZ09iai5kZWx0YVggPSBkZWx0YVg7XHJcblx0XHRkcmFnT2JqLmRlbHRhWSA9IGRlbHRhWTtcclxuXHJcblx0XHRlVGFyZ2V0LnN0eWxlLnpJbmRleCA9IDk5OTk7XHJcblx0IFx0ZVRhcmdldC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcblx0IFx0ZVRhcmdldC5zdHlsZS5vcGFjaXR5ID0gXCIwXCI7XHJcblx0IFx0XHJcblx0fVxyXG5cdGxldCBkcmFnRW50ZXJJbkJsb2NrID0gKGUpID0+e1xyXG5cdFx0aWYgKGUudGFyZ2V0ID09PSBkcmFnT2JqLmVsZW0pe3JldHVybn1cclxuXHRcdGlmIChkcmFnT2JqLmVsZW0uY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiKXtyZXR1cm59XHJcblx0XHRsZXQgY29vcmQgPSBnZXRDb29yZHMoZS50YXJnZXQpO1xyXG5cdFx0aWYoTWF0aC5hYnMoY29vcmQudG9wIC0gZS5wYWdlWSkgPiAxNSl7XHJcblx0XHRcdGlmKGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTmFtZSAhPSBcImluQmxvY2tcIiAmJiBcclxuXHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZy5jbGFzc05hbWUgIT0gXCJwYXJlbnRJbkJsb2NrXCIpe1xyXG5cdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChNYXRoLmFicyhjb29yZC50b3AgLSBlLnBhZ2VZKSA8PSAxNSl7XHJcblx0XHRcdGlmIChlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMV0gPT09IGUudGFyZ2V0LnBhcmVudE5vZGUpe1xyXG5cdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRsZXQgZHJhZ0VudGVyT3V0QmxvY2sgPSAoZSk9PntcclxuXHRcdGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcImFkZENhcmRcIil7cmV0dXJufVxyXG5cdFx0aWYoZHJhZ09iai5lbGVtID09IHVuZGVmaW5lZCl7cmV0dXJufVxyXG5cdFx0aWYoKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIiB8fCBcclxuXHRcdFx0ZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tcIikgJiZcclxuXHRcdFx0ZHJhZ09iai5lbGVtLmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIiYmXHJcblx0XHRcdGRyYWdPYmouZWxlbSAhPT0gZS50YXJnZXQgJiZcclxuXHRcdFx0ZHJhZ09iai5lbGVtLnBhcmVudE5vZGUgIT09IGUudGFyZ2V0KXtcclxuXHRcdFx0bGV0IGNvb3JkID0gZ2V0Q29vcmRzKGUudGFyZ2V0KTtcclxuXHRcdFx0aWYgKE1hdGguYWJzKGNvb3JkLmxlZnQgLSBlLnBhZ2VYKSA+IDEwMCl7XHJcblx0XHRcdFx0aWYgKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIil7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChkcmFnT2JqLnBhcmVudCA9PT0gZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpe1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHRcdFx0fVx0ZWxzZSB7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZSBpZiAoTWF0aC5hYnMoY29vcmQubGVmdCAtIGUucGFnZVgpIDwgMTAwKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZS50YXJnZXQpXHJcblx0XHRcdFx0Y29uc29sZS5sb2coZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlKVxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGRyYWdPYmoucGFyZW50ID09PSBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZylcclxuXHRcdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiKXtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiZS5vdXRCbG9ja1RpdGxlXCIpXHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLCBkcmFnT2JqLnBhcmVudCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKChkcmFnT2JqLnBhcmVudCA9PT0gZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpKXtcclxuXHRcdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge3JldHVybjt9XHJcblx0fVxyXG5cdGxldCBkcmFnRW50ZXJUaXRsZSA9IChlKSA9PiB7XHJcblx0XHRpZiAoZHJhZ09iai5lbGVtLmNsYXNzTmFtZSAhPSBcImluQmxvY2tcIil7cmV0dXJufVxyXG5cdFx0aWYgKGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRFbGVtZW50Q291bnQgPiAyICkge3JldHVybn1cclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzFdKTtcclxuXHR9XHJcblx0bGV0ICBnZXRDb29yZHMgPSAoZWxlbSkgPT4geyBcclxuXHQgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cdFx0cmV0dXJuIHtcclxuXHQgICAgdG9wOiBib3gudG9wICsgcGFnZVlPZmZzZXQsXHJcblx0ICAgIGxlZnQ6IGJveC5sZWZ0ICsgcGFnZVhPZmZzZXRcclxuXHQgIH07XHJcblx0fVxyXG5cdGxldCBkcmFnRW5kID0gKGUpID0+e1xyXG5cdFx0ZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiID9cclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgZHJhZ09iai5zdHlsZSkgOlxyXG5cdFx0ZS50YXJnZXQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgZHJhZ09iai5zdHlsZSk7XHJcblx0XHRkcmFnT2JqLnBhcmVudC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuXHRcdGxldCBjbG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvbmVcIik7XHJcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNsb25lKTtcclxuXHR9XHJcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
