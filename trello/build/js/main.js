"use strict";window.onload=function(){var e={},t=document.getElementById("addList");t.onclick=function(e){document.getElementById("addName").style.display="block",t.style.display="none",document.getElementById("saveList").addEventListener("click",a,!1),document.getElementById("cancelList").addEventListener("click",n,!1),document.getElementById("nameList").focus()};var a=function(e){var a=document.getElementById("columns"),n=document.getElementById("nameList"),r=document.createElement("div"),l=document.createElement("div"),i=document.createElement("div"),c=document.createElement("div");r.classList.add("parentOutBlock"),a.insertBefore(r,a.children[a.children.length-1]),l.classList.add("outBlock"),l.setAttribute("draggable","true"),l.addEventListener("dragenter",s,!1),r.appendChild(l),i.classList.add("outBlockTitle"),i.innerText=n.value,i.setAttribute("draggable","true"),i.addEventListener("dragstart",o,!1),i.addEventListener("dragenter",p,!1),i.addEventListener("dragend",g,!1),l.appendChild(i),c.classList.add("addCard"),c.id="addCard",c.innerText="Добавить карточку...",c.style.display="flex",c.addEventListener("click",d,!1),l.appendChild(c),n.value=null,addName.style.display="none",t.style.display="block"},n=function(e){document.getElementById("addName").style.display="none",t.style.display="block"},d=function(e){var t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("textArea"),d=document.createElement("div"),s=document.createElement("button"),p=document.createElement("button");t.classList.add("parentInBlock");var c=e.target.parentNode.children.length-1;e.target.parentNode.insertBefore(t,e.target.parentNode.children[c]),a.classList.add("inBlock"),a.style.padding="0",a.style.backgroundColor="#E2E4E6",t.appendChild(a),a.setAttribute("draggable","true"),a.addEventListener("dragstart",o,!1),a.addEventListener("dragenter",i,!1),a.addEventListener("dragend",g,!1),n.classList.add("textArea"),n.id="textareaAddCard",a.appendChild(n),document.getElementById("textareaAddCard").focus(),d.classList.add("buttonsAddCard"),d.id="buttonsAddCardId",e.target.parentNode.appendChild(d),s.classList.add("buttonsAddCard--add"),s.innerText="Добавить",s.addEventListener("click",r,!1),d.appendChild(s),p.classList.add("buttonsAddCard--cancel"),p.innerText="Отмена",p.addEventListener("click",l,!1),d.appendChild(p),e.target.style.display="none"},r=function(e){var t=document.getElementById("textareaAddCard");t.parentNode.setAttribute("style","padding: 10px; background-color: #ffffff; width:250px;"),e.target.parentNode.previousSibling.style.display="block",e.target.parentNode.parentNode.removeChild(e.target.parentNode),t.parentNode.innerHTML=t.value},l=function(e){var t=document.getElementById("textareaAddCard"),a=t.parentNode.parentNode.parentNode;a.removeChild(document.getElementById("buttonsAddCardId"));var n=t.parentNode.parentNode.parentNode.children.length;a.children[n-1].style.display="block",a.removeChild(t.parentNode.parentNode),t.parentNode.removeChild(t)},o=function(t){var a=void 0,n=void 0;"outBlockTitle"==t.target.className?(n=t.target.parentNode.parentNode,a=t.target.parentNode):"inBlock"==t.target.className&&(n=t.target.parentNode,a=t.target),n.style.height=n.clientHeight-1+"px";var d=n.cloneNode(!0);document.body.appendChild(d),d.id="clone",d.style.position="absolute",d.style.top="-1000px",d.style.zIndex="-100";var r=c(t.target),l=t.pageX-r.left-30,o=t.pageY-r.top;t.dataTransfer.setDragImage(d,l,o),e.elem=t.target,e.parent=n,e.style=a.getAttribute("style"),e.deltaX=l,e.deltaY=o,a.style.zIndex=9999,a.style.position="absolute",a.style.opacity="0"},i=function(t){if(t.target!==e.elem&&"outBlockTitle"!=e.elem.className){var a=c(t.target);Math.abs(a.top-t.pageY)>15?"inBlock"!=t.target.parentNode.nextElementSibling.className&&"parentInBlock"!=t.target.parentNode.nextElementSibling.className?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):Math.abs(a.top-t.pageY)<=15&&(t.target.parentNode.parentNode.children[1]===t.target.parentNode?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},s=function(t){if("addCard"!=t.target.className&&null!=e.elem&&("outBlockTitle"==t.target.className||"outBlock"==t.target.className)&&"outBlockTitle"==e.elem.className&&e.elem!==t.target&&e.elem.parentNode!==t.target){var a=c(t.target);Math.abs(a.left-t.pageX)>135?e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):Math.abs(a.left-t.pageX)<135&&(t.target.parentNode.parentNode.children[0]===t.target.parentNode||e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},p=function(t){"inBlock"==e.elem.className&&(t.target.parentNode.childElementCount>2||t.target.parentNode.insertBefore(e.parent,t.target.parentNode.children[1]))},c=function(e){var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset}},g=function(t){"outBlockTitle"==t.target.className?t.target.parentNode.setAttribute("style",e.style):t.target.setAttribute("style",e.style),e.parent.style.height="100%";var a=document.getElementById("clone");document.body.removeChild(a)}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvbWUuanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwiZHJhZ09iaiIsImFkZExpc3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwib25jbGljayIsImUiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwic2F2ZUxpc3QiLCJjYW5jZWxBZGRMaXN0IiwiZm9jdXMiLCJjb2x1bW5zIiwibmFtZUxpc3QiLCJwYXJlbnRPdXRCbG9jayIsImNyZWF0ZUVsZW1lbnQiLCJvdXRCbG9jayIsIm91dEJsb2NrVGl0bGUiLCJhZGRDYXJkIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5zZXJ0QmVmb3JlIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJzZXRBdHRyaWJ1dGUiLCJkcmFnRW50ZXJPdXRCbG9jayIsImFwcGVuZENoaWxkIiwiaW5uZXJUZXh0IiwidmFsdWUiLCJkcmFnU3RhcnQiLCJkcmFnRW50ZXJUaXRsZSIsImRyYWdFbmQiLCJpZCIsImFkZENhcmRJbkxpc3QiLCJhZGROYW1lIiwicGFyZW50SW5CbG9jayIsImluQmxvY2siLCJ0ZXh0QXJlYSIsImJ1dHRvbnNEaXYiLCJidXR0b25BZGQiLCJidXR0b25DYW5jZWwiLCJpbmRleCIsInRhcmdldCIsInBhcmVudE5vZGUiLCJwYWRkaW5nIiwiYmFja2dyb3VuZENvbG9yIiwiZHJhZ0VudGVySW5CbG9jayIsInNhdmVDYXJkSW5MaXN0IiwiY2FuY2VsQWRkQ2FyZEluTElzdCIsInRleHRhcmVhIiwicHJldmlvdXNTaWJsaW5nIiwicmVtb3ZlQ2hpbGQiLCJpbm5lckhUTUwiLCJwYXJlbnQiLCJlVGFyZ2V0IiwiY2xhc3NOYW1lIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiY2xvbmUiLCJjbG9uZU5vZGUiLCJib2R5IiwicG9zaXRpb24iLCJ0b3AiLCJ6SW5kZXgiLCJjb29yZHMiLCJnZXRDb29yZHMiLCJkZWx0YVgiLCJwYWdlWCIsImxlZnQiLCJkZWx0YVkiLCJwYWdlWSIsImRhdGFUcmFuc2ZlciIsInNldERyYWdJbWFnZSIsImVsZW0iLCJnZXRBdHRyaWJ1dGUiLCJvcGFjaXR5IiwiY29vcmQiLCJNYXRoIiwiYWJzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidW5kZWZpbmVkIiwiY2hpbGRFbGVtZW50Q291bnQiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJwYWdlWU9mZnNldCIsInBhZ2VYT2Zmc2V0Il0sIm1hcHBpbmdzIjoiYUFBQUEsT0FBT0MsT0FBUyxXQUNmLElBQUlDLEtBQ0FDLEVBQVVDLFNBQVNDLGVBQWUsV0FDdENGLEVBQVFHLFFBQVUsU0FBQ0MsR0FDSkgsU0FBU0MsZUFBZSxXQUM3QkcsTUFBTUMsUUFBVSxRQUN4Qk4sRUFBUUssTUFBTUMsUUFBVSxPQUNkTCxTQUFTQyxlQUFlLFlBQzdCSyxpQkFBaUIsUUFBU0MsR0FBVSxHQUM3QlAsU0FBU0MsZUFBZSxjQUM3QkssaUJBQWlCLFFBQVNFLEdBQWUsR0FDaERSLFNBQVNDLGVBQWUsWUFBWVEsU0FFdEMsSUFBSUYsRUFBVyxTQUFDSixHQUNmLElBQUlPLEVBQVVWLFNBQVNDLGVBQWUsV0FDckNVLEVBQVdYLFNBQVNDLGVBQWUsWUFDbkNXLEVBQWlCWixTQUFTYSxjQUFjLE9BQ3hDQyxFQUFXZCxTQUFTYSxjQUFjLE9BQ2xDRSxFQUFnQmYsU0FBU2EsY0FBYyxPQUN2Q0csRUFBVWhCLFNBQVNhLGNBQWMsT0FFbENELEVBQWVLLFVBQVVDLElBQUksa0JBQzdCUixFQUFRUyxhQUFhUCxFQUFnQkYsRUFBUVUsU0FBU1YsRUFBUVUsU0FBU0MsT0FBUyxJQUVoRlAsRUFBU0csVUFBVUMsSUFBSSxZQUN2QkosRUFBU1EsYUFBYSxZQUFhLFFBQ25DUixFQUFTUixpQkFBaUIsWUFBYWlCLEdBQW1CLEdBQzFEWCxFQUFlWSxZQUFZVixHQUUzQkMsRUFBY0UsVUFBVUMsSUFBSSxpQkFDNUJILEVBQWNVLFVBQVlkLEVBQVNlLE1BQ25DWCxFQUFjTyxhQUFhLFlBQWEsUUFDdkNQLEVBQWNULGlCQUFpQixZQUFhcUIs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aW5kb3cub25sb2FkID0gKCkgPT4ge1xyXG5cdGxldCBkcmFnT2JqID0ge307XHJcblx0bGV0IGFkZExpc3RcdD0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRMaXN0XCIpO1xyXG5cdGFkZExpc3Qub25jbGljayA9IChlKT0+e1xyXG5cdFx0bGV0IGFkZE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZE5hbWVcIik7XHJcblx0XHRcdGFkZE5hbWUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHRcdFx0YWRkTGlzdC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0XHRsZXQgc2F2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2F2ZUxpc3RcIik7XHJcblx0XHRcdHNhdmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNhdmVMaXN0LCBmYWxzZSk7XHJcblx0XHRsZXQgY2FuY2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxMaXN0XCIpO1xyXG5cdFx0XHRjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNhbmNlbEFkZExpc3QsIGZhbHNlKTtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lTGlzdFwiKS5mb2N1cygpO1xyXG5cdH1cclxuXHRsZXQgc2F2ZUxpc3QgPSAoZSk9PntcclxuXHRcdGxldCBjb2x1bW5zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb2x1bW5zXCIpLFxyXG5cdFx0XHRuYW1lTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZUxpc3RcIiksXHJcblx0XHRcdHBhcmVudE91dEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdFx0b3V0QmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxyXG5cdFx0XHRvdXRCbG9ja1RpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdFx0YWRkQ2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblxyXG5cdFx0cGFyZW50T3V0QmxvY2suY2xhc3NMaXN0LmFkZChcInBhcmVudE91dEJsb2NrXCIpO1xyXG5cdFx0Y29sdW1ucy5pbnNlcnRCZWZvcmUocGFyZW50T3V0QmxvY2ssIGNvbHVtbnMuY2hpbGRyZW5bY29sdW1ucy5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblxyXG5cdFx0b3V0QmxvY2suY2xhc3NMaXN0LmFkZChcIm91dEJsb2NrXCIpO1xyXG5cdFx0b3V0QmxvY2suc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xyXG5cdFx0b3V0QmxvY2suYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgZHJhZ0VudGVyT3V0QmxvY2ssIGZhbHNlKTtcclxuXHRcdHBhcmVudE91dEJsb2NrLmFwcGVuZENoaWxkKG91dEJsb2NrKTtcclxuXHRcdFxyXG5cdFx0b3V0QmxvY2tUaXRsZS5jbGFzc0xpc3QuYWRkKFwib3V0QmxvY2tUaXRsZVwiKTtcclxuXHRcdG91dEJsb2NrVGl0bGUuaW5uZXJUZXh0ID0gbmFtZUxpc3QudmFsdWU7XHJcblx0XHRvdXRCbG9ja1RpdGxlLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcclxuIFx0XHRvdXRCbG9ja1RpdGxlLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGRyYWdTdGFydCwgZmFsc2UpO1xyXG4gXHRcdG91dEJsb2NrVGl0bGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgZHJhZ0VudGVyVGl0bGUsIGZhbHNlKTtcclxuICAgIFx0b3V0QmxvY2tUaXRsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgZHJhZ0VuZCwgZmFsc2UpO1xyXG4gICAgXHRvdXRCbG9jay5hcHBlbmRDaGlsZChvdXRCbG9ja1RpdGxlKTtcclxuXHRcdFxyXG5cdFx0YWRkQ2FyZC5jbGFzc0xpc3QuYWRkKFwiYWRkQ2FyZFwiKTtcclxuXHRcdGFkZENhcmQuaWQgPSBcImFkZENhcmRcIjtcclxuXHRcdGFkZENhcmQuaW5uZXJUZXh0ID0gXCLQlNC+0LHQsNCy0LjRgtGMINC60LDRgNGC0L7Rh9C60YMuLi5cIjtcclxuXHRcdGFkZENhcmQuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xyXG5cclxuXHRcdGFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFkZENhcmRJbkxpc3QsIGZhbHNlKTtcclxuXHRcdG91dEJsb2NrLmFwcGVuZENoaWxkKGFkZENhcmQpO1xyXG5cclxuXHRcdG5hbWVMaXN0LnZhbHVlID0gbnVsbDtcclxuXHRcdGFkZE5hbWUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdFx0YWRkTGlzdC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdH1cclxuXHJcblx0bGV0ICBjYW5jZWxBZGRMaXN0ID0gKGUpPT57XHJcblx0XHRsZXQgYWRkTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkTmFtZVwiKTtcclxuXHRcdGFkZE5hbWUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdFx0YWRkTGlzdC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdH1cclxuXHRsZXQgYWRkQ2FyZEluTGlzdCA9IChlKT0+e1xyXG5cdFx0bGV0IHBhcmVudEluQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxyXG5cdFx0XHRpbkJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdCAgICB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0QXJlYVwiKSxcclxuXHRcdCAgICBidXR0b25zRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdCAgICBidXR0b25BZGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpLFxyXG5cdFx0ICAgIGJ1dHRvbkNhbmNlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcblx0XHQgICAgXHJcblx0ICAgIC8v0LLRgdGC0LDQstC70Y/QtdC8INC/0LXRgNC10LQg0LrQvdC+0L/QutC+0Lkg0LTQvtCx0LDQstC40YLRjCDRgdC/0LjRgdC+0LpcclxuXHQgICAgcGFyZW50SW5CbG9jay5jbGFzc0xpc3QuYWRkKFwicGFyZW50SW5CbG9ja1wiKTtcclxuXHQgICAgbGV0IGluZGV4ID0gZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cdCAgICBlLnRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShwYXJlbnRJbkJsb2NrLCBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuW2luZGV4XSk7XHJcblx0XHJcblx0ICAgIGluQmxvY2suY2xhc3NMaXN0LmFkZChcImluQmxvY2tcIik7XHJcblx0XHRpbkJsb2NrLnN0eWxlLnBhZGRpbmcgPSBcIjBcIjtcclxuXHRcdGluQmxvY2suc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRTJFNEU2XCI7XHJcblx0XHRwYXJlbnRJbkJsb2NrLmFwcGVuZENoaWxkKGluQmxvY2spO1xyXG5cdFx0aW5CbG9jay5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsICd0cnVlJyk7XHJcbiBcdFx0aW5CbG9jay5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBkcmFnU3RhcnQsIGZhbHNlKTtcclxuIFx0XHRpbkJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdFbnRlckluQmxvY2ssIGZhbHNlKTtcclxuICAgIFx0aW5CbG9jay5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgZHJhZ0VuZCwgZmFsc2UpO1xyXG5cdFx0XHRcclxuXHRcdHRleHRBcmVhLmNsYXNzTGlzdC5hZGQoXCJ0ZXh0QXJlYVwiKTtcclxuXHRcdHRleHRBcmVhLmlkID0gXCJ0ZXh0YXJlYUFkZENhcmRcIjtcclxuXHRcdGluQmxvY2suYXBwZW5kQ2hpbGQodGV4dEFyZWEpO1xyXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0YXJlYUFkZENhcmRcIikuZm9jdXMoKTtcclxuXHRcdC8vdGV4dEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgbG9zZUZvY3VzVGV4dGFyZWEsIGZhbHNlKTtcclxuXHJcblx0XHRidXR0b25zRGl2LmNsYXNzTGlzdC5hZGQoXCJidXR0b25zQWRkQ2FyZFwiKTtcclxuXHRcdGJ1dHRvbnNEaXYuaWQgPSBcImJ1dHRvbnNBZGRDYXJkSWRcIjtcclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoYnV0dG9uc0Rpdik7XHJcblxyXG5cdFx0YnV0dG9uQWRkLmNsYXNzTGlzdC5hZGQoXCJidXR0b25zQWRkQ2FyZC0tYWRkXCIpO1xyXG5cdFx0YnV0dG9uQWRkLmlubmVyVGV4dCA9IFwi0JTQvtCx0LDQstC40YLRjFwiO1xyXG5cdFx0YnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzYXZlQ2FyZEluTGlzdCwgZmFsc2UpO1xyXG5cdFx0YnV0dG9uc0Rpdi5hcHBlbmRDaGlsZChidXR0b25BZGQpO1xyXG5cclxuXHRcdGJ1dHRvbkNhbmNlbC5jbGFzc0xpc3QuYWRkKFwiYnV0dG9uc0FkZENhcmQtLWNhbmNlbFwiKTtcclxuXHRcdGJ1dHRvbkNhbmNlbC5pbm5lclRleHQgPSBcItCe0YLQvNC10L3QsFwiO1xyXG5cdFx0YnV0dG9uQ2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYW5jZWxBZGRDYXJkSW5MSXN0LCBmYWxzZSk7XHJcblx0XHRidXR0b25zRGl2LmFwcGVuZENoaWxkKGJ1dHRvbkNhbmNlbCk7XHJcblxyXG5cdFx0ZS50YXJnZXQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdH1cclxuXHJcblx0bGV0IHNhdmVDYXJkSW5MaXN0ID0gKGUpPT57XHJcblx0XHRsZXQgdGV4dGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRleHRhcmVhQWRkQ2FyZFwiKTtcclxuXHRcdHRleHRhcmVhLnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJwYWRkaW5nOiAxMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyB3aWR0aDoyNTBweDtcIik7XHJcblx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnByZXZpb3VzU2libGluZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0dGV4dGFyZWEucGFyZW50Tm9kZS5pbm5lckhUTUwgPSB0ZXh0YXJlYS52YWx1ZTtcclxuXHR9XHJcblxyXG5cdGxldCBjYW5jZWxBZGRDYXJkSW5MSXN0ID0gKGUpPT57XHJcblx0XHRsZXQgdGV4dGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRleHRhcmVhQWRkQ2FyZFwiKTtcclxuXHRcdGxldCBwYXJlbnQgPSB0ZXh0YXJlYS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcclxuXHRcdHBhcmVudC5yZW1vdmVDaGlsZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ1dHRvbnNBZGRDYXJkSWRcIikpO1xyXG5cdFx0XHJcblx0XHRsZXQgaW5kZXggPSB0ZXh0YXJlYS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGg7XHJcblx0XHRwYXJlbnQuY2hpbGRyZW5baW5kZXggLSAxXS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdFx0cGFyZW50LnJlbW92ZUNoaWxkKHRleHRhcmVhLnBhcmVudE5vZGUucGFyZW50Tm9kZSk7XHJcblx0XHR0ZXh0YXJlYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRleHRhcmVhKTtcclxuXHR9XHJcblx0bGV0IGxvc2VGb2N1c1RleHRhcmVhID0gKGUpPT57XHJcblx0fVx0XHJcblx0bGV0IGRyYWdTdGFydCA9IChlKSA9PntcclxuXHRcdGxldCBlVGFyZ2V0LCBwYXJlbnQsIGRlbHRhQ29vcmRzO1xyXG5cdFx0aWYoZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiKXtcclxuXHQgXHRcdHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcclxuXHQgXHRcdGVUYXJnZXQgPSBlLnRhcmdldC5wYXJlbnROb2RlO1xyXG5cdCBcdH0gZWxzZSBpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJpbkJsb2NrXCIpIHtcclxuXHRcdFx0cGFyZW50ID0gZS50YXJnZXQucGFyZW50Tm9kZTtcclxuXHQgXHRcdGVUYXJnZXQgPSBlLnRhcmdldDtcclxuXHQgXHR9XHJcblx0IFx0cGFyZW50LnN0eWxlLmhlaWdodCA9IHBhcmVudC5jbGllbnRIZWlnaHQgLSAxICsgXCJweFwiO1xyXG5cdFx0XHJcblx0XHRsZXQgY2xvbmUgPSBwYXJlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG5cdCBcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2xvbmUpO1xyXG5cdFx0Y2xvbmUuaWQgPSBcImNsb25lXCI7XHJcblx0XHRjbG9uZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjsgICAgXHJcblx0XHRjbG9uZS5zdHlsZS50b3AgPSBcIi0xMDAwcHhcIjtcclxuXHRcdGNsb25lLnN0eWxlLnpJbmRleCA9IFwiLTEwMFwiO1xyXG5cdFx0IFxyXG5cdFx0bGV0IGNvb3JkcyA9IGdldENvb3JkcyhlLnRhcmdldCk7XHJcblx0XHRsZXQgZGVsdGFYID0gZS5wYWdlWCAtIGNvb3Jkcy5sZWZ0IC0gMzAsXHJcblx0XHQgICAgZGVsdGFZID0gZS5wYWdlWSAtIGNvb3Jkcy50b3A7XHJcblx0XHRlLmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoY2xvbmUsIGRlbHRhWCwgZGVsdGFZKTsgXHJcblx0XHRkcmFnT2JqLmVsZW0gPSBlLnRhcmdldDtcclxuXHRcdGRyYWdPYmoucGFyZW50ID0gcGFyZW50O1xyXG5cdFx0ZHJhZ09iai5zdHlsZSA9IGVUYXJnZXQuZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7XHJcblx0XHRkcmFnT2JqLmRlbHRhWCA9IGRlbHRhWDtcclxuXHRcdGRyYWdPYmouZGVsdGFZID0gZGVsdGFZO1xyXG5cclxuXHRcdGVUYXJnZXQuc3R5bGUuekluZGV4ID0gOTk5OTtcclxuXHQgXHRlVGFyZ2V0LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHQgXHRlVGFyZ2V0LnN0eWxlLm9wYWNpdHkgPSBcIjBcIjtcclxuXHQgXHRcclxuXHR9XHJcblx0bGV0IGRyYWdFbnRlckluQmxvY2sgPSAoZSkgPT57XHJcblx0XHRpZiAoZS50YXJnZXQgPT09IGRyYWdPYmouZWxlbSl7cmV0dXJufVxyXG5cdFx0aWYgKGRyYWdPYmouZWxlbS5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCIpe3JldHVybn1cclxuXHRcdGxldCBjb29yZCA9IGdldENvb3JkcyhlLnRhcmdldCk7XHJcblx0XHRpZihNYXRoLmFicyhjb29yZC50b3AgLSBlLnBhZ2VZKSA+IDE1KXtcclxuXHRcdFx0aWYoZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NOYW1lICE9IFwiaW5CbG9ja1wiICYmIFxyXG5cdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTmFtZSAhPSBcInBhcmVudEluQmxvY2tcIil7XHJcblx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKE1hdGguYWJzKGNvb3JkLnRvcCAtIGUucGFnZVkpIDw9IDE1KXtcclxuXHRcdFx0aWYgKGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlblsxXSA9PT0gZS50YXJnZXQucGFyZW50Tm9kZSl7XHJcblx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGxldCBkcmFnRW50ZXJPdXRCbG9jayA9IChlKT0+e1xyXG5cdFx0aWYoZS50YXJnZXQuY2xhc3NOYW1lID09IFwiYWRkQ2FyZFwiKXtyZXR1cm59XHJcblx0XHRpZihkcmFnT2JqLmVsZW0gPT0gdW5kZWZpbmVkKXtyZXR1cm59XHJcblx0XHRpZigoZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiIHx8IFxyXG5cdFx0XHRlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1wiKSAmJlxyXG5cdFx0XHRkcmFnT2JqLmVsZW0uY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiJiZcclxuXHRcdFx0ZHJhZ09iai5lbGVtICE9PSBlLnRhcmdldCAmJlxyXG5cdFx0XHRkcmFnT2JqLmVsZW0ucGFyZW50Tm9kZSAhPT0gZS50YXJnZXQpe1xyXG5cdFx0XHRsZXQgY29vcmQgPSBnZXRDb29yZHMoZS50YXJnZXQpO1xyXG5cdFx0XHRpZiAoTWF0aC5hYnMoY29vcmQubGVmdCAtIGUucGFnZVgpID4gMTM1KXtcclxuXHRcdFx0XHRpZihkcmFnT2JqLnBhcmVudCA9PT0gZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpe1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHRcdFx0fVx0ZWxzZSB7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZSBpZiAoTWF0aC5hYnMoY29vcmQubGVmdCAtIGUucGFnZVgpIDwgMTM1KSB7XHJcblx0XHRcdFx0aWYoKGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlblswXSA9PT0gZS50YXJnZXQucGFyZW50Tm9kZSkgfHxcclxuXHRcdFx0XHRcdChkcmFnT2JqLnBhcmVudCA9PT0gZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpKXtcclxuXHRcdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge3JldHVybjt9XHJcblx0fVxyXG5cdGxldCBkcmFnRW50ZXJUaXRsZSA9IChlKSA9PiB7XHJcblx0XHRpZiAoZHJhZ09iai5lbGVtLmNsYXNzTmFtZSAhPSBcImluQmxvY2tcIil7cmV0dXJufVxyXG5cdFx0aWYgKGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRFbGVtZW50Q291bnQgPiAyICkge3JldHVybn1cclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzFdKTtcclxuXHR9XHJcblx0bGV0ICBnZXRDb29yZHMgPSAoZWxlbSkgPT4geyBcclxuXHQgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cdFx0cmV0dXJuIHtcclxuXHQgICAgdG9wOiBib3gudG9wICsgcGFnZVlPZmZzZXQsXHJcblx0ICAgIGxlZnQ6IGJveC5sZWZ0ICsgcGFnZVhPZmZzZXRcclxuXHQgIH07XHJcblx0fVxyXG5cdGxldCBkcmFnRW5kID0gKGUpID0+e1xyXG5cdFx0ZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiID9cclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgZHJhZ09iai5zdHlsZSkgOlxyXG5cdFx0ZS50YXJnZXQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgZHJhZ09iai5zdHlsZSk7XHJcblx0XHRkcmFnT2JqLnBhcmVudC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuXHRcdGxldCBjbG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvbmVcIik7XHJcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNsb25lKTtcclxuXHR9XHJcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
