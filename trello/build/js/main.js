"use strict";window.onload=function(){var e={},t=document.getElementById("addList");t.onclick=function(e){document.getElementById("addName").style.display="block",t.style.display="none",document.getElementById("saveList").addEventListener("click",a,!1),document.getElementById("cancelList").addEventListener("click",n,!1),document.getElementById("nameList").focus()};var a=function(e){var a=document.getElementById("columns"),n=document.getElementById("nameList"),r=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),c=document.createElement("div");r.classList.add("parentOutBlock"),a.insertBefore(r,a.children[a.children.length-1]),o.classList.add("outBlock"),o.setAttribute("draggable","true"),o.addEventListener("dragenter",s,!1),r.appendChild(o),i.classList.add("outBlockTitle"),i.innerText=n.value,i.setAttribute("draggable","true"),i.addEventListener("dragstart",l,!1),i.addEventListener("dragenter",p,!1),i.addEventListener("dragend",g,!1),o.appendChild(i),c.classList.add("addCard"),c.id="addCard",c.innerText="Добавить карточку...",c.style.display="flex",c.addEventListener("click",d,!1),o.appendChild(c),n.value=null,addName.style.display="none",t.style.display="block"},n=function(e){document.getElementById("addName").style.display="none",t.style.display="block"},d=function(e){var t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("textArea"),d=document.createElement("div"),s=document.createElement("button"),p=document.createElement("button");t.classList.add("parentInBlock");var c=e.target.parentNode.children.length-1;e.target.parentNode.insertBefore(t,e.target.parentNode.children[c]),a.classList.add("inBlock"),a.style.padding="0",a.style.backgroundColor="#E2E4E6",t.appendChild(a),a.setAttribute("draggable","true"),a.addEventListener("dragstart",l,!1),a.addEventListener("dragenter",i,!1),a.addEventListener("dragend",g,!1),n.classList.add("textArea"),n.id="textareaAddCard",a.appendChild(n),document.getElementById("textareaAddCard").focus(),d.classList.add("buttonsAddCard"),d.id="buttonsAddCardId",e.target.parentNode.appendChild(d),s.classList.add("buttonsAddCard--add"),s.innerText="Добавить",s.addEventListener("click",r,!1),d.appendChild(s),p.classList.add("buttonsAddCard--cancel"),p.innerText="Отмена",p.addEventListener("click",o,!1),d.appendChild(p),e.target.style.display="none"},r=function(e){var t=document.getElementById("textareaAddCard");t.parentNode.setAttribute("style","padding: 10px; background-color: #ffffff; width:160px;"),e.target.parentNode.previousSibling.style.display="block",e.target.parentNode.parentNode.removeChild(e.target.parentNode),t.parentNode.innerHTML=t.value},o=function(e){var t=document.getElementById("textareaAddCard"),a=t.parentNode.parentNode.parentNode;a.removeChild(document.getElementById("buttonsAddCardId"));var n=t.parentNode.parentNode.parentNode.children.length;a.children[n-1].style.display="block",a.removeChild(t.parentNode.parentNode),t.parentNode.removeChild(t)},l=function(t){var a=void 0,n=void 0;"outBlockTitle"==t.target.className?(n=t.target.parentNode.parentNode,a=t.target.parentNode):"inBlock"==t.target.className&&(n=t.target.parentNode,a=t.target),n.style.height=n.clientHeight-1+"px";var d=n.cloneNode(!0);document.body.appendChild(d),d.id="clone",d.style.position="absolute",d.style.top="-1000px",d.style.zIndex="-100";var r=c(t.target),o=t.pageX-r.left-30,l=t.pageY-r.top;t.dataTransfer.setDragImage(d,o,l),e.elem=t.target,e.parent=n,e.style=a.getAttribute("style"),e.deltaX=o,e.deltaY=l,a.style.zIndex=9999,a.style.position="absolute",a.style.opacity="0"},i=function(t){if(t.target!==e.elem&&"outBlockTitle"!=e.elem.className){var a=c(t.target);Math.abs(a.top-t.pageY)>15?"inBlock"!=t.target.parentNode.nextElementSibling.className&&"parentInBlock"!=t.target.parentNode.nextElementSibling.className?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):Math.abs(a.top-t.pageY)<=15&&(t.target.parentNode.parentNode.children[1]===t.target.parentNode?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},s=function(t){if("addCard"!=t.target.className&&null!=e.elem&&("outBlockTitle"==t.target.className||"outBlock"==t.target.className)&&"outBlockTitle"==e.elem.className&&e.elem!==t.target&&e.elem.parentNode!==t.target){var a=c(t.target);Math.abs(a.left-t.pageX)>100?"outBlockTitle"==t.target.className?t.target.parentNode.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.parentNode):e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling):Math.abs(a.left-t.pageX)<100&&("outBlockTitle"==t.target.className?t.target.parentNode.parentNode.parentNode.insertBefore(t.target.parentNode.parentNode,e.parent):e.parent===t.target.parentNode.nextElementSibling?t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode):t.target.parentNode.parentNode.insertBefore(e.parent,t.target.parentNode.nextElementSibling))}},p=function(t){"inBlock"==e.elem.className&&(t.target.parentNode.childElementCount>2||t.target.parentNode.insertBefore(e.parent,t.target.parentNode.children[1]))},c=function(e){var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset}},g=function(t){"outBlockTitle"==t.target.className?t.target.parentNode.setAttribute("style",e.style):t.target.setAttribute("style",e.style),e.parent.style.height="100%";var a=document.getElementById("clone");document.body.removeChild(a)}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvbWUuanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwiZHJhZ09iaiIsImFkZExpc3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwib25jbGljayIsImUiLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwic2F2ZUxpc3QiLCJjYW5jZWxBZGRMaXN0IiwiZm9jdXMiLCJjb2x1bW5zIiwibmFtZUxpc3QiLCJwYXJlbnRPdXRCbG9jayIsImNyZWF0ZUVsZW1lbnQiLCJvdXRCbG9jayIsIm91dEJsb2NrVGl0bGUiLCJhZGRDYXJkIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5zZXJ0QmVmb3JlIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJzZXRBdHRyaWJ1dGUiLCJkcmFnRW50ZXJPdXRCbG9jayIsImFwcGVuZENoaWxkIiwiaW5uZXJUZXh0IiwidmFsdWUiLCJkcmFnU3RhcnQiLCJkcmFnRW50ZXJUaXRsZSIsImRyYWdFbmQiLCJpZCIsImFkZENhcmRJbkxpc3QiLCJhZGROYW1lIiwicGFyZW50SW5CbG9jayIsImluQmxvY2siLCJ0ZXh0QXJlYSIsImJ1dHRvbnNEaXYiLCJidXR0b25BZGQiLCJidXR0b25DYW5jZWwiLCJpbmRleCIsInRhcmdldCIsInBhcmVudE5vZGUiLCJwYWRkaW5nIiwiYmFja2dyb3VuZENvbG9yIiwiZHJhZ0VudGVySW5CbG9jayIsInNhdmVDYXJkSW5MaXN0IiwiY2FuY2VsQWRkQ2FyZEluTElzdCIsInRleHRhcmVhIiwicHJldmlvdXNTaWJsaW5nIiwicmVtb3ZlQ2hpbGQiLCJpbm5lckhUTUwiLCJwYXJlbnQiLCJlVGFyZ2V0IiwiY2xhc3NOYW1lIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiY2xvbmUiLCJjbG9uZU5vZGUiLCJib2R5IiwicG9zaXRpb24iLCJ0b3AiLCJ6SW5kZXgiLCJjb29yZHMiLCJnZXRDb29yZHMiLCJkZWx0YVgiLCJwYWdlWCIsImxlZnQiLCJkZWx0YVkiLCJwYWdlWSIsImRhdGFUcmFuc2ZlciIsInNldERyYWdJbWFnZSIsImVsZW0iLCJnZXRBdHRyaWJ1dGUiLCJvcGFjaXR5IiwiY29vcmQiLCJNYXRoIiwiYWJzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidW5kZWZpbmVkIiwiY2hpbGRFbGVtZW50Q291bnQiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJwYWdlWU9mZnNldCIsInBhZ2VYT2Zmc2V0Il0sIm1hcHBpbmdzIjoiYUFBQUEsT0FBT0MsT0FBUyxXQUNmLElBQUlDLEtBQ0FDLEVBQVVDLFNBQVNDLGVBQWUsV0FDdENGLEVBQVFHLFFBQVUsU0FBQ0MsR0FDSkgsU0FBU0MsZUFBZSxXQUM3QkcsTUFBTUMsUUFBVSxRQUN4Qk4sRUFBUUssTUFBTUMsUUFBVSxPQUNkTCxTQUFTQyxlQUFlLFlBQzdCSyxpQkFBaUIsUUFBU0MsR0FBVSxHQUM3QlAsU0FBU0MsZUFBZSxjQUM3QkssaUJBQWlCLFFBQVNFLEdBQWUsR0FDaERSLFNBQVNDLGVBQWUsWUFBWVEsU0FFdEMsSUFBSUYsRUFBVyxTQUFDSixHQUNmLElBQUlPLEVBQVVWLFNBQVNDLGVBQWUsV0FDckNVLEVBQVdYLFNBQVNDLGVBQWUsWUFDbkNXLEVBQWlCWixTQUFTYSxjQUFjLE9BQ3hDQyxFQUFXZCxTQUFTYSxjQUFjLE9BQ2xDRSxFQUFnQmYsU0FBU2EsY0FBYyxPQUN2Q0csRUFBVWhCLFNBQVNhLGNBQWMsT0FFbENELEVBQWVLLFVBQVVDLElBQUksa0JBQzdCUixFQUFRUyxhQUFhUCxFQUFnQkYsRUFBUVUsU0FBU1YsRUFBUVUsU0FBU0MsT0FBUyxJQUVoRlAsRUFBU0csVUFBVUMsSUFBSSxZQUN2QkosRUFBU1EsYUFBYSxZQUFhLFFBQ25DUixFQUFTUixpQkFBaUIsWUFBYWlCLEdBQW1CLEdBQzFEWCxFQUFlWSxZQUFZVixHQUUzQkMsRUFBY0UsVUFBVUMsSUFBSSxpQkFDNUJILEVBQWNVLFVBQVlkLEVBQVNlLE1BQ25DWCxFQUFjTyxhQUFhLFlBQWEsUUFDdkNQLEVBQWNULGlCQUFpQixZQUFhcUIs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QyxPQUFPbEIsYUFBYSxRQUFTeEIsRUFBUU0sT0FDdkNOLEVBQVFxRCxPQUFPL0MsTUFBTWtELE9BQVMsT0FDOUIsSUFBSUUsRUFBUXhELFNBQVNDLGVBQWUsU0FDcENELFNBQVMwRCxLQUFLVCxZQUFZTyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuXHRsZXQgZHJhZ09iaiA9IHt9O1xyXG5cdGxldCBhZGRMaXN0XHQ9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkTGlzdFwiKTtcclxuXHRhZGRMaXN0Lm9uY2xpY2sgPSAoZSk9PntcclxuXHRcdGxldCBhZGROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGROYW1lXCIpO1xyXG5cdFx0XHRhZGROYW1lLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0XHRcdGFkZExpc3Quc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdFx0bGV0IHNhdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhdmVMaXN0XCIpO1xyXG5cdFx0XHRzYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzYXZlTGlzdCwgZmFsc2UpO1xyXG5cdFx0bGV0IGNhbmNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsTGlzdFwiKTtcclxuXHRcdFx0Y2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYW5jZWxBZGRMaXN0LCBmYWxzZSk7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZUxpc3RcIikuZm9jdXMoKTtcclxuXHR9XHJcblx0bGV0IHNhdmVMaXN0ID0gKGUpPT57XHJcblx0XHRsZXQgY29sdW1ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29sdW1uc1wiKSxcclxuXHRcdFx0bmFtZUxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVMaXN0XCIpLFxyXG5cdFx0XHRwYXJlbnRPdXRCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHRcdG91dEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuXHRcdFx0b3V0QmxvY2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHRcdGFkZENhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG5cclxuXHRcdHBhcmVudE91dEJsb2NrLmNsYXNzTGlzdC5hZGQoXCJwYXJlbnRPdXRCbG9ja1wiKTtcclxuXHRcdGNvbHVtbnMuaW5zZXJ0QmVmb3JlKHBhcmVudE91dEJsb2NrLCBjb2x1bW5zLmNoaWxkcmVuW2NvbHVtbnMuY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cclxuXHRcdG91dEJsb2NrLmNsYXNzTGlzdC5hZGQoXCJvdXRCbG9ja1wiKTtcclxuXHRcdG91dEJsb2NrLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcclxuXHRcdG91dEJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdFbnRlck91dEJsb2NrLCBmYWxzZSk7XHJcblx0XHRwYXJlbnRPdXRCbG9jay5hcHBlbmRDaGlsZChvdXRCbG9jayk7XHJcblx0XHRcclxuXHRcdG91dEJsb2NrVGl0bGUuY2xhc3NMaXN0LmFkZChcIm91dEJsb2NrVGl0bGVcIik7XHJcblx0XHRvdXRCbG9ja1RpdGxlLmlubmVyVGV4dCA9IG5hbWVMaXN0LnZhbHVlO1xyXG5cdFx0b3V0QmxvY2tUaXRsZS5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsICd0cnVlJyk7XHJcbiBcdFx0b3V0QmxvY2tUaXRsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBkcmFnU3RhcnQsIGZhbHNlKTtcclxuIFx0XHRvdXRCbG9ja1RpdGxlLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdFbnRlclRpdGxlLCBmYWxzZSk7XHJcbiAgICBcdG91dEJsb2NrVGl0bGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGRyYWdFbmQsIGZhbHNlKTtcclxuICAgIFx0Ly9vdXRCbG9ja1RpdGxlLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWcnLCBkcmFnLCBmYWxzZSk7XHJcbiAgICBcdG91dEJsb2NrLmFwcGVuZENoaWxkKG91dEJsb2NrVGl0bGUpO1xyXG5cdFx0XHJcblx0XHRhZGRDYXJkLmNsYXNzTGlzdC5hZGQoXCJhZGRDYXJkXCIpO1xyXG5cdFx0YWRkQ2FyZC5pZCA9IFwiYWRkQ2FyZFwiO1xyXG5cdFx0YWRkQ2FyZC5pbm5lclRleHQgPSBcItCU0L7QsdCw0LLQuNGC0Ywg0LrQsNGA0YLQvtGH0LrRgy4uLlwiO1xyXG5cdFx0YWRkQ2FyZC5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XHJcblxyXG5cdFx0YWRkQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYWRkQ2FyZEluTGlzdCwgZmFsc2UpO1xyXG5cdFx0b3V0QmxvY2suYXBwZW5kQ2hpbGQoYWRkQ2FyZCk7XHJcblxyXG5cdFx0bmFtZUxpc3QudmFsdWUgPSBudWxsO1xyXG5cdFx0YWRkTmFtZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0XHRhZGRMaXN0LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0fVxyXG5cclxuXHRsZXQgIGNhbmNlbEFkZExpc3QgPSAoZSk9PntcclxuXHRcdGxldCBhZGROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGROYW1lXCIpO1xyXG5cdFx0YWRkTmFtZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0XHRhZGRMaXN0LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0fVxyXG5cdGxldCBhZGRDYXJkSW5MaXN0ID0gKGUpPT57XHJcblx0XHRsZXQgcGFyZW50SW5CbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcblx0XHRcdGluQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxyXG5cdFx0ICAgIHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRBcmVhXCIpLFxyXG5cdFx0ICAgIGJ1dHRvbnNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxyXG5cdFx0ICAgIGJ1dHRvbkFkZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiksXHJcblx0XHQgICAgYnV0dG9uQ2FuY2VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuXHRcdCAgICBcclxuXHQgICAgLy/QstGB0YLQsNCy0LvRj9C10Lwg0L/QtdGA0LXQtCDQutC90L7Qv9C60L7QuSDQtNC+0LHQsNCy0LjRgtGMINGB0L/QuNGB0L7QulxyXG5cdCAgICBwYXJlbnRJbkJsb2NrLmNsYXNzTGlzdC5hZGQoXCJwYXJlbnRJbkJsb2NrXCIpO1xyXG5cdCAgICBsZXQgaW5kZXggPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuLmxlbmd0aCAtIDE7XHJcblx0ICAgIGUudGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHBhcmVudEluQmxvY2ssIGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRyZW5baW5kZXhdKTtcclxuXHRcclxuXHQgICAgaW5CbG9jay5jbGFzc0xpc3QuYWRkKFwiaW5CbG9ja1wiKTtcclxuXHRcdGluQmxvY2suc3R5bGUucGFkZGluZyA9IFwiMFwiO1xyXG5cdFx0aW5CbG9jay5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNFMkU0RTZcIjtcclxuXHRcdHBhcmVudEluQmxvY2suYXBwZW5kQ2hpbGQoaW5CbG9jayk7XHJcblx0XHRpbkJsb2NrLnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcclxuIFx0XHRpbkJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGRyYWdTdGFydCwgZmFsc2UpO1xyXG4gXHRcdGluQmxvY2suYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgZHJhZ0VudGVySW5CbG9jaywgZmFsc2UpO1xyXG4gICAgXHRpbkJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCBkcmFnRW5kLCBmYWxzZSk7XHJcbiAgICBcdC8vaW5CbG9jay5hZGRFdmVudExpc3RlbmVyKCdkcmFnJywgZHJhZywgZmFsc2UpO1xyXG5cdFxyXG5cdFx0dGV4dEFyZWEuY2xhc3NMaXN0LmFkZChcInRleHRBcmVhXCIpO1xyXG5cdFx0dGV4dEFyZWEuaWQgPSBcInRleHRhcmVhQWRkQ2FyZFwiO1xyXG5cdFx0aW5CbG9jay5hcHBlbmRDaGlsZCh0ZXh0QXJlYSk7XHJcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRleHRhcmVhQWRkQ2FyZFwiKS5mb2N1cygpO1xyXG5cdFx0Ly90ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBsb3NlRm9jdXNUZXh0YXJlYSwgZmFsc2UpO1xyXG5cclxuXHRcdGJ1dHRvbnNEaXYuY2xhc3NMaXN0LmFkZChcImJ1dHRvbnNBZGRDYXJkXCIpO1xyXG5cdFx0YnV0dG9uc0Rpdi5pZCA9IFwiYnV0dG9uc0FkZENhcmRJZFwiO1xyXG5cdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChidXR0b25zRGl2KTtcclxuXHJcblx0XHRidXR0b25BZGQuY2xhc3NMaXN0LmFkZChcImJ1dHRvbnNBZGRDYXJkLS1hZGRcIik7XHJcblx0XHRidXR0b25BZGQuaW5uZXJUZXh0ID0gXCLQlNC+0LHQsNCy0LjRgtGMXCI7XHJcblx0XHRidXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNhdmVDYXJkSW5MaXN0LCBmYWxzZSk7XHJcblx0XHRidXR0b25zRGl2LmFwcGVuZENoaWxkKGJ1dHRvbkFkZCk7XHJcblxyXG5cdFx0YnV0dG9uQ2FuY2VsLmNsYXNzTGlzdC5hZGQoXCJidXR0b25zQWRkQ2FyZC0tY2FuY2VsXCIpO1xyXG5cdFx0YnV0dG9uQ2FuY2VsLmlubmVyVGV4dCA9IFwi0J7RgtC80LXQvdCwXCI7XHJcblx0XHRidXR0b25DYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNhbmNlbEFkZENhcmRJbkxJc3QsIGZhbHNlKTtcclxuXHRcdGJ1dHRvbnNEaXYuYXBwZW5kQ2hpbGQoYnV0dG9uQ2FuY2VsKTtcclxuXHJcblx0XHRlLnRhcmdldC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0fVxyXG5cclxuXHRsZXQgc2F2ZUNhcmRJbkxpc3QgPSAoZSk9PntcclxuXHRcdGxldCB0ZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGV4dGFyZWFBZGRDYXJkXCIpO1xyXG5cdFx0dGV4dGFyZWEucGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInBhZGRpbmc6IDEwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7IHdpZHRoOjE2MHB4O1wiKTtcclxuXHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucHJldmlvdXNTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHR0ZXh0YXJlYS5wYXJlbnROb2RlLmlubmVySFRNTCA9IHRleHRhcmVhLnZhbHVlO1xyXG5cdH1cclxuXHJcblx0bGV0IGNhbmNlbEFkZENhcmRJbkxJc3QgPSAoZSk9PntcclxuXHRcdGxldCB0ZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGV4dGFyZWFBZGRDYXJkXCIpO1xyXG5cdFx0bGV0IHBhcmVudCA9IHRleHRhcmVhLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xyXG5cdFx0cGFyZW50LnJlbW92ZUNoaWxkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnV0dG9uc0FkZENhcmRJZFwiKSk7XHJcblx0XHRcclxuXHRcdGxldCBpbmRleCA9IHRleHRhcmVhLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuLmxlbmd0aDtcclxuXHRcdHBhcmVudC5jaGlsZHJlbltpbmRleCAtIDFdLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0XHRwYXJlbnQucmVtb3ZlQ2hpbGQodGV4dGFyZWEucGFyZW50Tm9kZS5wYXJlbnROb2RlKTtcclxuXHRcdHRleHRhcmVhLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGV4dGFyZWEpO1xyXG5cdH1cclxuXHRsZXQgbG9zZUZvY3VzVGV4dGFyZWEgPSAoZSk9PntcclxuXHR9XHRcclxuXHRsZXQgZHJhZ1N0YXJ0ID0gKGUpID0+e1xyXG5cdFx0bGV0IGVUYXJnZXQsIHBhcmVudCwgZGVsdGFDb29yZHM7XHJcblx0XHRpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCIpe1xyXG5cdCBcdFx0cGFyZW50ID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xyXG5cdCBcdFx0ZVRhcmdldCA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XHJcblx0IFx0fSBlbHNlIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcImluQmxvY2tcIikge1xyXG5cdFx0XHRwYXJlbnQgPSBlLnRhcmdldC5wYXJlbnROb2RlO1xyXG5cdCBcdFx0ZVRhcmdldCA9IGUudGFyZ2V0O1xyXG5cdCBcdH1cclxuXHQgXHRwYXJlbnQuc3R5bGUuaGVpZ2h0ID0gcGFyZW50LmNsaWVudEhlaWdodCAtIDEgKyBcInB4XCI7XHJcblx0XHRcclxuXHRcdGxldCBjbG9uZSA9IHBhcmVudC5jbG9uZU5vZGUodHJ1ZSk7XHJcblx0IFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjbG9uZSk7XHJcblx0XHRjbG9uZS5pZCA9IFwiY2xvbmVcIjtcclxuXHRcdGNsb25lLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiOyAgICBcclxuXHRcdGNsb25lLnN0eWxlLnRvcCA9IFwiLTEwMDBweFwiO1xyXG5cdFx0Y2xvbmUuc3R5bGUuekluZGV4ID0gXCItMTAwXCI7XHJcblx0XHQgXHJcblx0XHRsZXQgY29vcmRzID0gZ2V0Q29vcmRzKGUudGFyZ2V0KTtcclxuXHRcdGxldCBkZWx0YVggPSBlLnBhZ2VYIC0gY29vcmRzLmxlZnQgLSAzMCxcclxuXHRcdCAgICBkZWx0YVkgPSBlLnBhZ2VZIC0gY29vcmRzLnRvcDtcclxuXHRcdGUuZGF0YVRyYW5zZmVyLnNldERyYWdJbWFnZShjbG9uZSwgZGVsdGFYLCBkZWx0YVkpOyBcclxuXHRcdGRyYWdPYmouZWxlbSA9IGUudGFyZ2V0O1xyXG5cdFx0ZHJhZ09iai5wYXJlbnQgPSBwYXJlbnQ7XHJcblx0XHRkcmFnT2JqLnN0eWxlID0gZVRhcmdldC5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcclxuXHRcdGRyYWdPYmouZGVsdGFYID0gZGVsdGFYO1xyXG5cdFx0ZHJhZ09iai5kZWx0YVkgPSBkZWx0YVk7XHJcblxyXG5cdFx0ZVRhcmdldC5zdHlsZS56SW5kZXggPSA5OTk5O1xyXG5cdCBcdGVUYXJnZXQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG5cdCBcdGVUYXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xyXG5cdCBcdFxyXG5cdH1cclxuXHRsZXQgZHJhZ0VudGVySW5CbG9jayA9IChlKSA9PntcclxuXHRcdGlmIChlLnRhcmdldCA9PT0gZHJhZ09iai5lbGVtKXtyZXR1cm59XHJcblx0XHRpZiAoZHJhZ09iai5lbGVtLmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIil7cmV0dXJufVxyXG5cdFx0bGV0IGNvb3JkID0gZ2V0Q29vcmRzKGUudGFyZ2V0KTtcclxuXHRcdGlmKE1hdGguYWJzKGNvb3JkLnRvcCAtIGUucGFnZVkpID4gMTUpe1xyXG5cdFx0XHRpZihlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZy5jbGFzc05hbWUgIT0gXCJpbkJsb2NrXCIgJiYgXHJcblx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NOYW1lICE9IFwicGFyZW50SW5CbG9ja1wiKXtcclxuXHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAoTWF0aC5hYnMoY29vcmQudG9wIC0gZS5wYWdlWSkgPD0gMTUpe1xyXG5cdFx0XHRpZiAoZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuWzFdID09PSBlLnRhcmdldC5wYXJlbnROb2RlKXtcclxuXHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0bGV0IGRyYWdFbnRlck91dEJsb2NrID0gKGUpPT57XHJcblx0XHRpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJhZGRDYXJkXCIpe3JldHVybn1cclxuXHRcdGlmKGRyYWdPYmouZWxlbSA9PSB1bmRlZmluZWQpe3JldHVybn1cclxuXHRcdGlmKChlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCIgfHwgXHJcblx0XHRcdGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrXCIpICYmXHJcblx0XHRcdGRyYWdPYmouZWxlbS5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCImJlxyXG5cdFx0XHRkcmFnT2JqLmVsZW0gIT09IGUudGFyZ2V0ICYmXHJcblx0XHRcdGRyYWdPYmouZWxlbS5wYXJlbnROb2RlICE9PSBlLnRhcmdldCl7XHJcblx0XHRcdGxldCBjb29yZCA9IGdldENvb3JkcyhlLnRhcmdldCk7XHJcblx0XHRcdGlmIChNYXRoLmFicyhjb29yZC5sZWZ0IC0gZS5wYWdlWCkgPiAxMDApe1xyXG5cdFx0XHRcdGlmIChlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCIpe1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoZHJhZ09iai5wYXJlbnQgPT09IGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKXtcclxuXHRcdFx0XHRcdGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZHJhZ09iai5wYXJlbnQsIGUudGFyZ2V0LnBhcmVudE5vZGUpO1xyXG5cdFx0XHRcdH1cdGVsc2Uge1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fWVsc2UgaWYgKE1hdGguYWJzKGNvb3JkLmxlZnQgLSBlLnBhZ2VYKSA8IDEwMCkge1xyXG5cdFx0XHRcdGlmIChlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJvdXRCbG9ja1RpdGxlXCIpe1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZSwgZHJhZ09iai5wYXJlbnQpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZigoZHJhZ09iai5wYXJlbnQgPT09IGUudGFyZ2V0LnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKSl7XHJcblx0XHRcdFx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGRyYWdPYmoucGFyZW50LCBlLnRhcmdldC5wYXJlbnROb2RlKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtyZXR1cm47fVxyXG5cdH1cclxuXHRsZXQgZHJhZ0VudGVyVGl0bGUgPSAoZSkgPT4ge1xyXG5cdFx0aWYgKGRyYWdPYmouZWxlbS5jbGFzc05hbWUgIT0gXCJpbkJsb2NrXCIpe3JldHVybn1cclxuXHRcdGlmIChlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkRWxlbWVudENvdW50ID4gMiApIHtyZXR1cm59XHJcblx0XHRlLnRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkcmFnT2JqLnBhcmVudCwgZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlblsxXSk7XHJcblx0fVxyXG5cdGxldCAgZ2V0Q29vcmRzID0gKGVsZW0pID0+IHsgXHJcblx0ICB2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHRcdHJldHVybiB7XHJcblx0ICAgIHRvcDogYm94LnRvcCArIHBhZ2VZT2Zmc2V0LFxyXG5cdCAgICBsZWZ0OiBib3gubGVmdCArIHBhZ2VYT2Zmc2V0XHJcblx0ICB9O1xyXG5cdH1cclxuXHRsZXQgZHJhZ0VuZCA9IChlKSA9PntcclxuXHRcdGUudGFyZ2V0LmNsYXNzTmFtZSA9PSBcIm91dEJsb2NrVGl0bGVcIiA/XHJcblx0XHRlLnRhcmdldC5wYXJlbnROb2RlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIGRyYWdPYmouc3R5bGUpIDpcclxuXHRcdGUudGFyZ2V0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIGRyYWdPYmouc3R5bGUpO1xyXG5cdFx0ZHJhZ09iai5wYXJlbnQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcblx0XHRsZXQgY2xvbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb25lXCIpO1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjbG9uZSk7XHJcblx0fVxyXG5cdC8vIGxldCBkcmFnID0gKGUpPT57XHJcblx0Ly8gXHRjb25zb2xlLmxvZyhlLnRhcmdldC5wYXJlbnROb2RlKVxyXG5cdC8vIFx0aWYoZS50YXJnZXQuY2xhc3NOYW1lID09IFwib3V0QmxvY2tUaXRsZVwiKXtcclxuXHQvLyBcdFx0ZS50YXJnZXQucGFyZW50Tm9kZS5zdHlsZS5vcGFjaXR5ID0gXCIwXCI7XHJcblx0Ly8gXHR9IGVsc2Uge1xyXG5cdC8vIFx0XHRlLnRhcmdldC5zdHlsZS5vcGFjaXR5ID0gXCIwXCI7XHJcblx0Ly8gXHR9XHJcblx0XHRcclxuXHQvLyB9XHJcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
