"use strict";var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CreateCheckers=function(){function e(t,i,r,s,o,c,l,a){_classCallCheck(this,e),this.tag=t,this.parent=i,this.size=size,this.scale=r,this.fill=c,this.x=s||0,this.y=o||0,this.stroke=a||"#85653E",this.strokeWidth=l,this.elem}return _createClass(e,[{key:"create",value:function(){this.elem=document.createElementNS("http://www.w3.org/2000/svg",this.tag),this.parent.appendChild(this.elem)}},{key:"setAttributesSvg",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.parent==document.body&&(e=2*size),this.create(),this.elem.setAttribute("height",this.size*this.scale),this.elem.setAttribute("width",this.size*this.scale+e),this.elem.setAttribute("x",this.x),this.elem.setAttribute("y",this.y),this.elem}},{key:"setAttributesRect",value:function(){return this.create(),this.elem.setAttribute("height",this.size*this.scale),this.elem.setAttribute("width",this.size*this.scale),this.elem.setAttribute("fill",this.fill),this.elem.setAttribute("x",this.x),this.elem.setAttribute("y",this.y),this.elem.setAttribute("stroke",this.stroke),this.elem.setAttribute("stroke-width",this.strokeWidth),this.elem}},{key:"setAttributesCircle",value:function(e,t){return this.create(),this.elem.setAttribute("cx",this.x),this.elem.setAttribute("cy",this.y),this.elem.setAttribute("r",t),this.elem.setAttribute("fill",this.fill),this.elem.setAttribute("stroke",this.stroke),this.elem.setAttribute("stroke-width",this.strokeWidth),this.elem.classList.add(e,"slowmove"),this.elem.addEventListener("click",clickCircle,!1),this.elem}}]),e}(),size=Math.floor(.8*document.documentElement.clientHeight/8);size%2?size++:size=size;var container=new CreateCheckers("svg",document.body,9).setAttributesSvg(),outerBoard=new CreateCheckers("svg",container,9,size,0).setAttributesSvg(),strokeOuter=new CreateCheckers("rect",outerBoard,9,0,0,"#EDCFA9",5).setAttributesRect(),middleBoard=new CreateCheckers("svg",outerBoard,8.1,size/2-2,size/2-2).setAttributesSvg(),strokeMid=new CreateCheckers("rect",middleBoard,8.1,0,0,"#85653E",5).setAttributesRect(),innerBoard=new CreateCheckers("svg",middleBoard,8,3,3).setAttributesSvg();function createRect(){for(var e=0,t=0,i=0;i<8;i++){for(var r=0;r<8;r++){new CreateCheckers("rect",innerBoard,1,e,t,(i+r)%2?"#85653E":"#EDCFA9",2,"0").setAttributesRect();e+=size}e=0,t+=size}}function createCircle(){for(var e=1.5*size,t=size/2,i="#565455",r="#3C3B3B",s=0;s<6;s++){for(var o=0;o<4;o++){new CreateCheckers("circle",innerBoard,1,e,t,i,2,r).setAttributesCircle("black",size/3),new CreateCheckers("circle",innerBoard,1,e,t,i,2,r).setAttributesCircle("black",size/5);e+=2*size}2==s?(t=5.5*size,e=size/2,i="#D4E2CB",r="#F8FFEE"):s%2?(t+=size,e=1.5*size):(t+=size,e=size/2)}}function clickCircle(e){if(!this.classList.contains("lastMoved")){var t=Math.floor(this.getAttribute("cx")),i=Math.floor(this.getAttribute("cy"));searchMove(this,t,i)}}function sortCoord(e,t,i,r,s,o){var c=t[s].cx,l=t[s].cy,a=t[s+1].cx,n=t[s+1].cy,h=c-a>0?c-sizeRect:a-sizeRect,d=l-n>0?l-sizeRect:n-sizeRect,u=e[s].cx,f=e[s].cy,v=c!=a&&l!=n&&Math.abs(c-a)==2*sizeRect&&Math.abs(l-n)==2*sizeRect&&h==u&&d==f;if(v)if(o=!0,e.length>s+1&&e.length>1)sortCoord(e,t,i,r,s+1,!0);else{var C=t.slice(0,s+2),b=e.slice(0,s+1);i.push(C),r.push(b)}else if(!v){if(o){C=t.slice(0,s+1),b=e.slice(0,s);i.push(C),r.push(b)}t.splice(s,1),e.splice(s-1,1),sortCoord(e,t,i,r,s-1,!1)}}function addCoordDelete(e,t,i){var r={cx:e,cy:t};return i.push(r),i}function addCoordMove(e,t,i){var r={cx:e,cy:t};return i.push(r),i}createRect(),createCircle();var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,s=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done)&&(i.push(c.value),!t||i.length!==t);r=!0);}catch(e){s=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(s)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function findCoords(e,t,i,r,s,o,c,l){s.length||addCoordMove(e,t,s);var a=setCoords(e,t,o),n=_slicedToArray(a,5),h=n[0],d=n[1],u=n[2],f=n[3],v=n[4];if(validCoord(h,d)){var C=findNextElem(h,d);if("free"==C&&(c||i==v)&&null==l)createActiveRect(h,d,i).classList.add("simpleMove"),c&&findCoords(h,d,i,r,s,o,c,l);else if("black"==C&&"white"==i||"white"==C&&"black"==i){var b=setCoords(h,d,o),m=_slicedToArray(b,2),z=m[0],A=m[1];"free"==findNextElem(z,A)&&validCoord(z,A)&&1!=searchSimilarDelete(h,d,r)&&(addCoordDelete(h,d,r),addClassDelete(h,d),findCoords(h,d,i,r,s,o,c,l=!0))}else if("free"==C&&null!=l){createActiveRect(h,d,i).classList.add("kickMove"),addCoordMove(h,d,s);var k=setCoords(h,d,o),y=_slicedToArray(k,2),g=y[0],w=y[1];("free"!=findNextElem(g,w)||c)&&validCoord(g,w)&&findCoords(h,d,i,r,s,o,c,l),findCoords(h,d,i,r,s,u,c),findCoords(h,d,i,r,s,f,c)}}}function setCoords(e,t,i){var r=void 0,s=void 0,o=void 0;return"topLeft"===i?(e=Math.floor(e-sizeRect),t=Math.floor(t-sizeRect),r="topRigth",s="lowLeft",o="white"):"topRigth"===i?(e=Math.floor(e+sizeRect),t=Math.floor(t-sizeRect),r="topLeft",s="lowRigth",o="white"):"lowLeft"===i?(e=Math.floor(e-sizeRect),t=Math.floor(t+sizeRect),r="topLeft",s="lowRigth",o="black"):"lowRigth"===i&&(e=Math.floor(e+sizeRect),t=Math.floor(t+sizeRect),r="topRigth",s="lowLeft",o="black"),[e,t,r,s,o]}function addCoordDelete(e,t,i){var r={cx:e,cy:t,flag:"delete"};return i.push(r),i}function addCoordMove(e,t,i){var r={cx:e,cy:t,flag:"move"};return i.push(r),i}function addClassDelete(e,t){for(var i=0;i<circle.length;i++)circle[i].getAttribute("cx")==e&&circle[i].getAttribute("cy")==t&&circle[i].classList.add("delete")}var validCoord=function(e,t){return 0<=e&&e<=8*sizeRect&&0<=t&&t<=8*sizeRect};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFfY3JlYXRlQ2hlY2tlcnMuanMiLCJiX3N0YXJ0R2FtZS5qcyIsImNvb3JkaW5hdGVzLmpzIiwiY19maW5kQ29vcmRzLmpzIiwib3RoZXIuanMiXSwibmFtZXMiOlsiQ3JlYXRlQ2hlY2tlcnMiLCJ0YWciLCJwYXJlbnQiLCJzY2FsZSIsIngiLCJ5IiwiZmlsbCIsInN0cm9rZVdpZHRoIiwic3Ryb2tlIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsInNpemUiLCJlbGVtIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50TlMiLCJhcHBlbmRDaGlsZCIsIndpZHRoIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiYm9keSIsImNyZWF0ZSIsInNldEF0dHJpYnV0ZSIsImNvbG9yIiwiciIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGlja0NpcmNsZSIsIk1hdGgiLCJmbG9vciIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsImNvbnRhaW5lciIsInNldEF0dHJpYnV0ZXNTdmciLCJvdXRlckJvYXJkIiwic3Ryb2tlT3V0ZXIiLCJzZXRBdHRyaWJ1dGVzUmVjdCIsIm1pZGRsZUJvYXJkIiwic3Ryb2tlTWlkIiwiaW5uZXJCb2FyZCIsImNyZWF0ZVJlY3QiLCJqIiwiaSIsImNyZWF0ZUNpcmNsZSIsImN4IiwiY3kiLCJzZXRBdHRyaWJ1dGVzQ2lyY2xlIiwiZSIsImNvbnRhaW5zIiwiZ2V0QXR0cmlidXRlIiwic2VhcmNoTW92ZSIsInNvcnRDb29yZCIsImFyckRlbGV0ZSIsImFyck1vdmUiLCJhcnJDb29yZE1vdmUiLCJhcnJDb29yZERlbCIsImluZGV4IiwidmFsaWQiLCJjeF9sZWZ0IiwiY3lfbGVmdCIsImN4X3JpZ3RoIiwiY3lfcmlndGgiLCJjeF9taWRfcG90ZW50Iiwic2l6ZVJlY3QiLCJjeV9taWRfcG90ZW50IiwiY3hfbWlkX3JlYWwiLCJjeV9taWRfcmVhbCIsInZhbGlkUHVzaCIsImFicyIsInZhbGlkQ29vcmRNb3ZlIiwic2xpY2UiLCJ2YWxpZENvb3JkRGVsIiwicHVzaCIsInNwbGljZSIsImFkZENvb3JkRGVsZXRlIiwiZGVsIiwiYWRkQ29vcmRNb3ZlIiwibW92ZSIsImZpbmRDb29yZHMiLCJjb2xvckVsZW1lbnQiLCJ3YXkiLCJxdWVlbiIsIm5leHQiLCJfc2V0Q29vcmRzIiwic2V0Q29vcmRzIiwiX3NldENvb3JkczIiLCJfc2xpY2VkVG9BcnJheSIsIndheVRvcCIsIndheUxvdyIsIndheUNvbG9yIiwidmFsaWRDb29yZCIsIm5leHRFbGVtIiwiZmluZE5leHRFbGVtIiwiY3JlYXRlQWN0aXZlUmVjdCIsIl9zZXRDb29yZHMzIiwiX3NldENvb3JkczQiLCJjeF9hZnRlciIsImN5X2FmdGVyIiwic2VhcmNoU2ltaWxhckRlbGV0ZSIsImFkZENsYXNzRGVsZXRlIiwiX3NldENvb3JkczUiLCJfc2V0Q29vcmRzNiIsImZsYWciLCJjaXJjbGUiXSwibWFwcGluZ3MiOiJpWUFBTUEsMEJBQ0osU0FBQUEsRUFBWUMsRUFBS0MsRUFBUUMsRUFBT0MsRUFBR0MsRUFBR0MsRUFBTUMsRUFBYUMsR0FBUUMsZ0JBQUFDLEtBQUFWLEdBQy9EVSxLQUFLVCxJQUFNQSxFQUNYUyxLQUFLUixPQUFTQSxFQUNkUSxLQUFLQyxLQUFPQSxLQUNaRCxLQUFLUCxNQUFRQSxFQUNiTyxLQUFLSixLQUFPQSxFQUNaSSxLQUFLTixFQUFJQSxHQUFLLEVBQ2RNLEtBQUtMLEVBQUlBLEdBQUssRUFDZEssS0FBS0YsT0FBU0EsR0FBVSxVQUN4QkUsS0FBS0gsWUFBY0EsRUFDbkJHLEtBQUtFLDJEQUdMRixLQUFLRSxLQUFPQyxTQUFTQyxnQkFBZ0IsNkJBQThCSixLQUFLVCxLQUN4RVMsS0FBS1IsT0FBT2EsWUFBWUwsS0FBS0UsaURBRUgsSUFBWEksRUFBV0MsVUFBQUMsT0FBQSxRQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBSCxFQU92QixPQU5BUCxLQUFLUixRQUFVVyxTQUFTTyxPQUFPSixFQUFlLEVB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eUQsS0FBTyxRQUdSLE9BREFqRCxFQUFRbUIsS0FBS0ssR0FDTnhCLEVDaEdSLFNBQVM4QyxlQUFldkQsRUFBSUMsR0FDM0IsSUFBSyxJQUFJSCxFQUFJLEVBQUdBLEVBQUk2RCxPQUFPdEYsT0FBUXlCLElBQzlCNkQsT0FBTzdELEdBQUdPLGFBQWEsT0FBU0wsR0FDbkMyRCxPQUFPN0QsR0FBR08sYUFBYSxPQUFTSixHQUNoQzBELE9BQU83RCxHQUFHbEIsVUFBVUMsSUFBSSxVQVExQixJQUFJaUUsV0FBYSxTQUFDOUMsRUFBSUMsR0FDdEIsT0FBUyxHQUFLRCxHQUFNQSxHQUFlLEVBQVRtQixVQUN2QixHQUFLbEIsR0FBTUEsR0FBZSxFQUFUa0IiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENyZWF0ZUNoZWNrZXJzIHtcclxuICBjb25zdHJ1Y3Rvcih0YWcsIHBhcmVudCwgc2NhbGUsIHgsIHksIGZpbGwsIHN0cm9rZVdpZHRoLCBzdHJva2UpIHtcclxuICAgIHRoaXMudGFnID0gdGFnO1xyXG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgdGhpcy5zY2FsZSA9IHNjYWxlO1xyXG4gICAgdGhpcy5maWxsID0gZmlsbDtcclxuICAgIHRoaXMueCA9IHggfHwgMDtcclxuICAgIHRoaXMueSA9IHkgfHwgMDtcclxuICAgIHRoaXMuc3Ryb2tlID0gc3Ryb2tlIHx8IFwiIzg1NjUzRVwiO1xyXG4gICAgdGhpcy5zdHJva2VXaWR0aCA9IHN0cm9rZVdpZHRoO1xyXG4gICAgdGhpcy5lbGVtO1xyXG4gIH1cclxuICBjcmVhdGUoKSB7XHJcbiAgICB0aGlzLmVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCB0aGlzLnRhZyk7XHJcbiAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLmVsZW0pO1xyXG4gIH1cclxuICBzZXRBdHRyaWJ1dGVzU3ZnKHdpZHRoID0gMCkge1xyXG4gICAgdGhpcy5wYXJlbnQgPT0gZG9jdW1lbnQuYm9keSA/IHdpZHRoID0gc2l6ZSAqIDIgOiAwO1xyXG4gICAgdGhpcy5jcmVhdGUoKTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5zaXplICogdGhpcy5zY2FsZSk7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgdGhpcy5zaXplICogdGhpcy5zY2FsZSArIHdpZHRoKTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJ4XCIsIHRoaXMueCk7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwieVwiLCB0aGlzLnkpO1xyXG4gICAgcmV0dXJuIHRoaXMuZWxlbTtcclxuICB9XHJcbiAgc2V0QXR0cmlidXRlc1JlY3QoKSB7XHJcbiAgICB0aGlzLmNyZWF0ZSgpO1xyXG4gICAgdGhpcy5lbGVtLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCB0aGlzLnNpemUgKiB0aGlzLnNjYWxlKTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCB0aGlzLnNpemUgKiB0aGlzLnNjYWxlKTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsIHRoaXMuZmlsbCk7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwieFwiLCB0aGlzLngpO1xyXG4gICAgdGhpcy5lbGVtLnNldEF0dHJpYnV0ZShcInlcIiwgdGhpcy55KTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgdGhpcy5zdHJva2UpO1xyXG4gICAgdGhpcy5lbGVtLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLCB0aGlzLnN0cm9rZVdpZHRoKTtcclxuICAgIHJldHVybiB0aGlzLmVsZW07XHJcbiAgfVxyXG4gIHNldEF0dHJpYnV0ZXNDaXJjbGUoY29sb3IsIHIpIHtcclxuICAgIHRoaXMuY3JlYXRlKCk7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwiY3hcIiwgdGhpcy54KTtcclxuICAgIHRoaXMuZWxlbS5zZXRBdHRyaWJ1dGUoXCJjeVwiLCB0aGlzLnkpO1xyXG4gICAgdGhpcy5lbGVtLnNldEF0dHJpYnV0ZShcInJcIiwgcik7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwiZmlsbFwiLCB0aGlzLmZpbGwpO1xyXG4gICAgdGhpcy5lbGVtLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCB0aGlzLnN0cm9rZSk7XHJcbiAgICB0aGlzLmVsZW0uc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIHRoaXMuc3Ryb2tlV2lkdGgpO1xyXG4gICAgdGhpcy5lbGVtLmNsYXNzTGlzdC5hZGQoY29sb3IsIFwic2xvd21vdmVcIik7XHJcbiAgICB0aGlzLmVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrQ2lyY2xlLCBmYWxzZSk7XHJcbiAgICByZXR1cm4gdGhpcy5lbGVtO1xyXG4gIH1cclxufVxyXG5cclxubGV0IHNpemUgPSBNYXRoLmZsb29yKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKiAuODAgIC8gOCk7XHJcbnNpemUgJSAyID8gc2l6ZSsrIDogc2l6ZSA9IHNpemU7XHJcbiAgICAgXHJcbmxldCBjb250YWluZXIgPSBuZXcgQ3JlYXRlQ2hlY2tlcnMoXCJzdmdcIiwgZG9jdW1lbnQuYm9keSwgOSkuc2V0QXR0cmlidXRlc1N2ZygpLFxyXG4gIG91dGVyQm9hcmQgPW5ldyBDcmVhdGVDaGVja2VycyhcInN2Z1wiLCBjb250YWluZXIsIDksIHNpemUsIDApLnNldEF0dHJpYnV0ZXNTdmcoKSxcclxuICBzdHJva2VPdXRlciA9IG5ldyBDcmVhdGVDaGVja2VycyhcInJlY3RcIiwgb3V0ZXJCb2FyZCwgOSwgMCwgMCwgXCIjRURDRkE5XCIsIDUpLnNldEF0dHJpYnV0ZXNSZWN0KCk7XHJcblxyXG5sZXQgbWlkZGxlQm9hcmQgPSBuZXcgQ3JlYXRlQ2hlY2tlcnMoXCJzdmdcIiwgb3V0ZXJCb2FyZCwgOC4xLCBzaXplLzItMiwgc2l6ZS8yLTIpLnNldEF0dHJpYnV0ZXNTdmcoKSxcclxuICBzdHJva2VNaWQgPSBuZXcgQ3JlYXRlQ2hlY2tlcnMoXCJyZWN0XCIsIG1pZGRsZUJvYXJkLCA4LjEsIDAsIDAsIFwiIzg1NjUzRVwiLCA1KS5zZXRBdHRyaWJ1dGVzUmVjdCgpO1xyXG5cclxubGV0IGlubmVyQm9hcmQgPSBuZXcgQ3JlYXRlQ2hlY2tlcnMoXCJzdmdcIiwgbWlkZGxlQm9hcmQsIDgsIDMsIDMpLnNldEF0dHJpYnV0ZXNTdmcoKTtcclxuY3JlYXRlUmVjdCgpO1xyXG5jcmVhdGVDaXJjbGUoKTtcclxuXHJcblxyXG5mdW5jdGlvbiBjcmVhdGVSZWN0KCkge1xyXG4gIGxldCBmaWxsLFxyXG4gICAgeCA9IDAsXHJcbiAgICB5ID0gMDtcclxuXHJcbiAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqKyspIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICAgICgoaiArIGkpICAlIDIpID8gZmlsbCA9IFwiIzg1NjUzRVwiIDogZmlsbCA9IFwiI0VEQ0ZBOVwiO1xyXG4gICAgICBsZXQgcmVjdEJvYXJkID0gbmV3IENyZWF0ZUNoZWNrZXJzKFwicmVjdFwiLCBpbm5lckJvYXJkLCAxLCB4LCB5LCBmaWxsLCAyLCBcIjBcIikuc2V0QXR0cmlidXRlc1JlY3QoKTtcclxuICAgICAgeCArPSBzaXplO1xyXG4gICAgfVxyXG4gICAgeCA9IDA7XHJcbiAgICB5ICs9IHNpemU7XHJcbiAgfSAgICBcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2lyY2xlKCkge1xyXG4gIGxldCBjeCA9IHNpemUgKiAxLjUsIFxyXG4gICAgY3kgPSBzaXplIC8gMixcclxuICAgIGZpbGwgPSBcIiM1NjU0NTVcIixcclxuICAgIHN0cm9rZSA9IFwiIzNDM0IzQlwiO1xyXG5cclxuICBmb3IgKGxldCBqID0gMDsgaiA8IDY7IGorKykge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcclxuICAgICAgbGV0IGNpcmNsZUJvYXJkID0gbmV3IENyZWF0ZUNoZWNrZXJzKFwiY2lyY2xlXCIsIGlubmVyQm9hcmQsIDEsIGN4LCBjeSwgZmlsbCwgMiwgc3Ryb2tlKS5zZXRBdHRyaWJ1dGVzQ2lyY2xlKFwiYmxhY2tcIiwgc2l6ZS8zKTtcclxuICAgICAgbGV0IHNtYWxsQ2lyY2xlQm9hcmQgPSBuZXcgQ3JlYXRlQ2hlY2tlcnMoXCJjaXJjbGVcIiwgaW5uZXJCb2FyZCwgMSwgY3gsIGN5LCBmaWxsLCAyLCBzdHJva2UpLnNldEF0dHJpYnV0ZXNDaXJjbGUoXCJibGFja1wiLCBzaXplLzUpO1xyXG4gICAgICBjeCArPSBzaXplICogMjtcclxuICAgIH1cclxuICAgICAgXHJcbiAgICBpZiAoaiA9PSAyKSB7XHJcbiAgICAgIGN5ID0gc2l6ZSAqIDUuNTtcclxuICAgICAgY3ggPSBzaXplLzI7XHJcbiAgICAgIGZpbGwgPSBcIiNENEUyQ0JcIjtcclxuICAgICAgc3Ryb2tlID0gXCIjRjhGRkVFXCI7XHJcbiAgICB9IGVsc2UgaWYgKGogJSAyKSB7XHJcbiAgICAgICAgY3kgKz0gc2l6ZTtcclxuICAgICAgICBjeCA9IHNpemUgKiAxLjU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN5ICs9IHNpemU7XHJcbiAgICAgICAgY3ggPSBzaXplLzI7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwiZnVuY3Rpb24gY2xpY2tDaXJjbGUoZSkge1xyXG5cdGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucygnbGFzdE1vdmVkJykpIHJldHVybjtcclxuXHRcclxuXHRsZXQgY3ggPSBNYXRoLmZsb29yKHRoaXMuZ2V0QXR0cmlidXRlKCBcImN4XCIpKSxcclxuXHRcdGN5ID0gTWF0aC5mbG9vcih0aGlzLmdldEF0dHJpYnV0ZSggXCJjeVwiKSk7XHJcblx0XHJcblx0c2VhcmNoTW92ZSh0aGlzLCBjeCwgY3kpO1xyXG59IiwiXHRcdFxyXG5mdW5jdGlvbiBzb3J0Q29vcmQoYXJyRGVsZXRlLCBhcnJNb3ZlLCBhcnJDb29yZE1vdmUsIGFyckNvb3JkRGVsLCBpbmRleCwgdmFsaWQpIHtcclxuXHR2YXIgY3hfbGVmdCA9IGFyck1vdmVbaW5kZXhdLmN4LFxyXG5cdCAgICBjeV9sZWZ0ID0gYXJyTW92ZVtpbmRleF0uY3k7XHJcblx0XHJcblx0dmFyIGN4X3JpZ3RoID0gYXJyTW92ZVtpbmRleCArIDFdLmN4LFxyXG5cdFx0Y3lfcmlndGggPSBhcnJNb3ZlW2luZGV4ICsgMV0uY3k7XHJcblx0XHJcblx0dmFyIGN4X21pZF9wb3RlbnQgPSAoY3hfbGVmdCAtIGN4X3JpZ3RoKSA+IDAgPyBjeF9sZWZ0IC0gc2l6ZVJlY3QgOiBjeF9yaWd0aCAtc2l6ZVJlY3QsXHJcblx0ICAgIGN5X21pZF9wb3RlbnQgPSAoY3lfbGVmdCAtIGN5X3JpZ3RoKSA+IDAgPyBjeV9sZWZ0IC0gc2l6ZVJlY3QgOiBjeV9yaWd0aCAtXHJcblx0ICAgIHNpemVSZWN0O1xyXG5cdFxyXG5cdHZhciBjeF9taWRfcmVhbCA9IGFyckRlbGV0ZVtpbmRleF0uY3gsXHJcblx0ICAgIGN5X21pZF9yZWFsID0gYXJyRGVsZXRlW2luZGV4XS5jeTtcclxuXHRcclxuXHR2YXIgdmFsaWRQdXNoID0gKGN4X2xlZnQgIT0gY3hfcmlndGgpICYmIChjeV9sZWZ0ICE9IGN5X3JpZ3RoKSAmJlxyXG5cdFx0KE1hdGguYWJzKGN4X2xlZnQgLSBjeF9yaWd0aCkgPT0gc2l6ZVJlY3QqMikgJiYgXHJcblx0XHQoTWF0aC5hYnMoY3lfbGVmdCAtIGN5X3JpZ3RoKSA9PSBzaXplUmVjdCoyKSAmJlxyXG5cdFx0Y3hfbWlkX3BvdGVudCA9PSBjeF9taWRfcmVhbCAmJiBjeV9taWRfcG90ZW50ID09IGN5X21pZF9yZWFsIDtcclxuXHRcclxuXHRpZiAodmFsaWRQdXNoKXtcclxuXHRcdHZhbGlkID0gdHJ1ZTtcclxuXHRcdGlmIChhcnJEZWxldGUubGVuZ3RoID4gaW5kZXggKyAxICYmIGFyckRlbGV0ZS5sZW5ndGggPiAxKSB7XHJcblx0XHRcdHNvcnRDb29yZChhcnJEZWxldGUsIGFyck1vdmUsIGFyckNvb3JkTW92ZSwgYXJyQ29vcmREZWwsIGluZGV4ICsgMSwgdHJ1ZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgdmFsaWRDb29yZE1vdmUgPSBhcnJNb3ZlLnNsaWNlKDAsIGluZGV4ICsgMiksXHJcblx0XHRcdCAgICB2YWxpZENvb3JkRGVsID0gYXJyRGVsZXRlLnNsaWNlKDAsIGluZGV4ICsgMSk7XHJcblx0XHRcdFxyXG5cdFx0XHRhcnJDb29yZE1vdmUucHVzaCh2YWxpZENvb3JkTW92ZSkgO1xyXG5cdFx0XHRhcnJDb29yZERlbC5wdXNoKHZhbGlkQ29vcmREZWwpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAoIXZhbGlkUHVzaCl7XHJcblx0XHRpZiAodmFsaWQpe1xyXG5cdFx0XHR2YXIgdmFsaWRDb29yZE1vdmUgPSBhcnJNb3ZlLnNsaWNlKDAsIGluZGV4ICsgMSksXHJcblx0XHRcdFx0dmFsaWRDb29yZERlbCA9IGFyckRlbGV0ZS5zbGljZSgwLCBpbmRleCk7XHJcblx0XHRcdFxyXG5cdFx0XHRhcnJDb29yZE1vdmUucHVzaCh2YWxpZENvb3JkTW92ZSkgO1xyXG5cdFx0XHRhcnJDb29yZERlbC5wdXNoKHZhbGlkQ29vcmREZWwpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRhcnJNb3ZlLnNwbGljZShpbmRleCwgMSk7XHJcblx0XHRhcnJEZWxldGUuc3BsaWNlKGluZGV4IC0gMSwgMSk7XHJcblx0XHRzb3J0Q29vcmQoYXJyRGVsZXRlLCBhcnJNb3ZlLCBhcnJDb29yZE1vdmUsIGFyckNvb3JkRGVsLCBpbmRleCAtIDEsIGZhbHNlKTtcclxuXHR9IFxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRDb29yZERlbGV0ZShjeCwgY3ksIGFyckRlbGV0ZSkge1xyXG5cdHZhciBkZWwgPSB7XHJcblx0XHRjeCxcclxuXHRcdGN5XHJcblx0fTtcclxuXHRhcnJEZWxldGUucHVzaChkZWwpO1xyXG5cdHJldHVybiBhcnJEZWxldGU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZENvb3JkTW92ZShjeCwgY3ksIGFyck1vdmUpIHtcclxuXHR2YXIgbW92ZSA9IHtcclxuXHRcdGN4LFxyXG5cdFx0Y3lcclxuXHR9O1xyXG5cdGFyck1vdmUucHVzaChtb3ZlKTtcclxuXHRyZXR1cm4gYXJyTW92ZTtcclxufSIsImZ1bmN0aW9uIGZpbmRDb29yZHMoeCwgeSwgY29sb3JFbGVtZW50LCBhcnJEZWxldGUsIGFyck1vdmUsIHdheSwgcXVlZW4sIG5leHQpe1xyXG5cdGlmICghYXJyTW92ZS5sZW5ndGgpIHsgYWRkQ29vcmRNb3ZlKHgsIHksIGFyck1vdmUpIH1cclxuXHRcclxuXHRsZXQgW2N4LCBjeSwgd2F5VG9wLCB3YXlMb3csIHdheUNvbG9yXSA9IHNldENvb3Jkcyh4LCB5LCB3YXkpO1xyXG5cdFxyXG5cdGlmICghdmFsaWRDb29yZChjeCwgY3kpKSByZXR1cm47XHJcblx0XHRcclxuXHRsZXQgbmV4dEVsZW0gPSBmaW5kTmV4dEVsZW0oY3gsIGN5KSxcclxuXHRcdGZyZWUgPSAobmV4dEVsZW0gPT0gXCJmcmVlXCIgJiYgXHJcblx0XHRcdChxdWVlbiB8fCBjb2xvckVsZW1lbnQgPT0gd2F5Q29sb3IpKSAmJiBcclxuXHRcdFx0KG5leHQgPT0gdW5kZWZpbmVkKTtcclxuXHRcdFxyXG5cdGlmIChmcmVlKSB7XHJcblx0XHRsZXQgcmVjdCA9IGNyZWF0ZUFjdGl2ZVJlY3QoY3gsIGN5LCBjb2xvckVsZW1lbnQpO1xyXG4gICAgICAgIHJlY3QuY2xhc3NMaXN0LmFkZChcInNpbXBsZU1vdmVcIik7XHJcblx0XHRpZihxdWVlbil7XHJcblx0XHRcdGZpbmRDb29yZHMoY3gsIGN5LCBjb2xvckVsZW1lbnQsIGFyckRlbGV0ZSwgYXJyTW92ZSwgd2F5LCBxdWVlbiwgbmV4dCk7XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmICgobmV4dEVsZW0gPT0gXCJibGFja1wiICYmIGNvbG9yRWxlbWVudCA9PSBcIndoaXRlXCIpIHx8IFxyXG5cdFx0XHRcdCAobmV4dEVsZW0gPT0gXCJ3aGl0ZVwiICYmIGNvbG9yRWxlbWVudCA9PSBcImJsYWNrXCIpKSB7XHJcblx0XHRcdFxyXG5cdFx0XHRsZXQgW2N4X2FmdGVyLCBjeV9hZnRlcl0gPSBzZXRDb29yZHMoY3gsIGN5LCB3YXkpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKChmaW5kTmV4dEVsZW0oY3hfYWZ0ZXIsIGN5X2FmdGVyKSA9PSBcImZyZWVcIikgJiYgXHJcblx0XHRcdFx0dmFsaWRDb29yZChjeF9hZnRlciwgY3lfYWZ0ZXIpICYmIFxyXG5cdFx0XHRcdHNlYXJjaFNpbWlsYXJEZWxldGUoY3gsIGN5LCBhcnJEZWxldGUpICE9IHRydWUpICB7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0YWRkQ29vcmREZWxldGUoY3gsIGN5LCBhcnJEZWxldGUpO1xyXG5cdFx0XHRcdGFkZENsYXNzRGVsZXRlKGN4LCBjeSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bmV4dCA9IHRydWU7XHJcblx0XHRcdFx0ZmluZENvb3JkcyhjeCwgY3ksIGNvbG9yRWxlbWVudCwgYXJyRGVsZXRlLCBhcnJNb3ZlLCB3YXksIHF1ZWVuLCBuZXh0KTtcclxuXHRcdFx0fVx0XHJcblx0fSBlbHNlIGlmIChuZXh0RWxlbSA9PSBcImZyZWVcIiAmJiBuZXh0ICE9IHVuZGVmaW5lZCl7XHJcblx0XHRcdGxldCByZWN0ID0gY3JlYXRlQWN0aXZlUmVjdChjeCwgY3ksIGNvbG9yRWxlbWVudCk7XHJcbiAgICAgICAgXHRyZWN0LmNsYXNzTGlzdC5hZGQoXCJraWNrTW92ZVwiKTtcclxuXHRcdFx0YWRkQ29vcmRNb3ZlKGN4LCBjeSwgYXJyTW92ZSk7XHJcbiAgICAgICAgXHRcclxuXHRcdFx0bGV0IFtjeF9hZnRlciwgY3lfYWZ0ZXJdID0gc2V0Q29vcmRzKGN4LCBjeSwgd2F5KTtcclxuXHRcdFx0XHJcblx0XHRcdGlmKChmaW5kTmV4dEVsZW0oY3hfYWZ0ZXIsIGN5X2FmdGVyKSAhPSBcImZyZWVcIiB8fCBxdWVlbikgJiZcclxuXHRcdFx0XHR2YWxpZENvb3JkKGN4X2FmdGVyLCBjeV9hZnRlcikpIHtcclxuXHRcdFx0XHRmaW5kQ29vcmRzKGN4LCBjeSwgY29sb3JFbGVtZW50LCBhcnJEZWxldGUsIGFyck1vdmUsIHdheSwgcXVlZW4sIG5leHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHRmaW5kQ29vcmRzKGN4LCBjeSwgY29sb3JFbGVtZW50LCBhcnJEZWxldGUsIGFyck1vdmUsIHdheVRvcCwgcXVlZW4pO1xyXG5cdFx0XHRmaW5kQ29vcmRzKGN4LCBjeSwgY29sb3JFbGVtZW50LCBhcnJEZWxldGUsIGFyck1vdmUsIHdheUxvdywgcXVlZW4pO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Q29vcmRzKGN4LCBjeSwgd2F5KSB7XHJcblx0bGV0IHdheVRvcCwgd2F5TG93LCB3YXlDb2xvcjtcclxuXHRpZiAod2F5ID09PSBcInRvcExlZnRcIikge1xyXG5cdFx0Y3ggID0gTWF0aC5mbG9vcihjeCAtIHNpemVSZWN0KSwgXHJcblx0XHRjeSAgPSBNYXRoLmZsb29yKGN5IC0gc2l6ZVJlY3QpLFxyXG5cdFx0d2F5VG9wID0gXCJ0b3BSaWd0aFwiLFxyXG5cdFx0d2F5TG93ID0gXCJsb3dMZWZ0XCIsXHJcblx0XHR3YXlDb2xvciA9IFwid2hpdGVcIjtcclxuXHR9IGVsc2UgaWYgKHdheSA9PT0gXCJ0b3BSaWd0aFwiKSB7XHJcblx0XHRjeCAgPSBNYXRoLmZsb29yKGN4ICsgc2l6ZVJlY3QpLCBcclxuXHRcdGN5ICA9IE1hdGguZmxvb3IoY3kgLSBzaXplUmVjdCksXHJcblx0XHR3YXlUb3AgPSBcInRvcExlZnRcIixcclxuXHRcdHdheUxvdyA9IFwibG93UmlndGhcIixcclxuXHRcdHdheUNvbG9yID0gXCJ3aGl0ZVwiO1xyXG5cdH0gZWxzZSBpZiAod2F5ID09PSBcImxvd0xlZnRcIikge1xyXG5cdFx0Y3ggID0gTWF0aC5mbG9vcihjeCAtIHNpemVSZWN0KSwgXHJcblx0XHRjeSAgPSBNYXRoLmZsb29yKGN5ICsgc2l6ZVJlY3QpO1xyXG5cdFx0d2F5VG9wID0gXCJ0b3BMZWZ0XCIsXHJcblx0XHR3YXlMb3cgPSBcImxvd1JpZ3RoXCIsXHJcblx0XHR3YXlDb2xvciA9IFwiYmxhY2tcIjtcclxuXHR9IGVsc2UgaWYgKHdheSA9PT0gXCJsb3dSaWd0aFwiKSB7XHJcblx0XHRjeCAgPSBNYXRoLmZsb29yKGN4ICsgc2l6ZVJlY3QpLCBcclxuXHRcdGN5ICAgID0gTWF0aC5mbG9vcihjeSArIHNpemVSZWN0KTtcclxuXHRcdHdheVRvcCA9IFwidG9wUmlndGhcIixcclxuXHRcdHdheUxvdyA9IFwibG93TGVmdFwiLFxyXG5cdFx0d2F5Q29sb3IgPSBcImJsYWNrXCI7XHJcblx0fVxyXG5cdHJldHVybiBbY3gsIGN5LCB3YXlUb3AsIHdheUxvdywgd2F5Q29sb3JdO1xyXG59XHJcblxyXG4vL9C/0YPRiNC40Lwg0LIg0LzQsNGB0YHQuNCyINC60L7QvtGA0LTQuNC90LDRgtGLINGE0LjQs9GD0YDRiywg0LrQvtGC0L7RgNGD0Y4g0LHRjNGO0YJcclxuZnVuY3Rpb24gYWRkQ29vcmREZWxldGUoY3gsIGN5LCBhcnJEZWxldGUpIHtcclxuXHR2YXIgZGVsID0ge1xyXG5cdFx0Y3gsXHJcblx0XHRjeSxcclxuXHRcdGZsYWcgOiBcImRlbGV0ZVwiXHJcblx0fTtcclxuXHRhcnJEZWxldGUucHVzaChkZWwpO1xyXG5cdHJldHVybiBhcnJEZWxldGU7XHJcbn1cclxuXHJcbi8v0L/Rg9GI0LjQvCDQsiDQvNCw0YHRgdC40LIg0LrQvtC+0YDQtNC40L3QsNGC0Ysg0YTQuNCz0YPRgNGLLCDQutC+0YLQvtGA0LDRjyDQsdGM0LXRglxyXG5mdW5jdGlvbiBhZGRDb29yZE1vdmUoY3gsIGN5LCBhcnJNb3ZlKSB7XHJcblx0dmFyIG1vdmUgPSB7XHJcblx0XHRjeCxcclxuXHRcdGN5LFxyXG5cdFx0ZmxhZyA6IFwibW92ZVwiXHJcblx0fTtcclxuXHRhcnJNb3ZlLnB1c2gobW92ZSk7XHJcblx0cmV0dXJuIGFyck1vdmU7XHJcbn0iLCIvKlxyXG4gKiBhZGQgY2xhc3NcclxuICovXHJcbmZ1bmN0aW9uIGFkZENsYXNzRGVsZXRlKGN4LCBjeSl7XHJcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjaXJjbGUubGVuZ3RoOyBpKyspIHtcclxuXHRcdGlmIChjaXJjbGVbaV0uZ2V0QXR0cmlidXRlKFwiY3hcIikgPT0gY3ggJiZcclxuXHRcdFx0Y2lyY2xlW2ldLmdldEF0dHJpYnV0ZShcImN5XCIpID09IGN5KXtcclxuXHRcdFx0Y2lyY2xlW2ldLmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZScpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLypcclxuICogY2hlY2sgdmFsaWQgY29vcmRpbmF0ZXNcclxuICovXHJcbiB2YXIgdmFsaWRDb29yZCA9IChjeCwgY3kpID0+IHtcclxuXHRyZXR1cm4gKCgwIDw9IGN4ICYmIGN4IDw9IHNpemVSZWN0KjgpICYmIFxyXG5cdFx0XHQoMCA8PSBjeSAmJiBjeSA8PSBzaXplUmVjdCo4KSkgPyB0cnVlIDogZmFsc2VcclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
